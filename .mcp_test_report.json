{
  "executed_at": "2025-12-22T21:54:12.149629Z",
  "root": "/Users/marcelkurvers/Development/funda-app",
  "summary": {
    "total_runs": 6,
    "success": 0,
    "failed": 1,
    "skipped": 5
  },
  "runs": [
    {
      "framework": "pytest",
      "command": "pytest",
      "exit_code": 1,
      "raw_output": "============================= test session starts ==============================\nplatform darwin -- Python 3.11.4, pytest-9.0.2, pluggy-1.6.0 -- /Library/Frameworks/Python.framework/Versions/3.11/bin/python3.11\ncachedir: .pytest_cache\nrootdir: /Users/marcelkurvers/Development/funda-app\nconfigfile: pytest.ini\ntestpaths: backend/tests\nplugins: anyio-4.10.0, asyncio-1.3.0\nasyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function\ncollecting ... collected 205 items\n\nbackend/tests/e2e/test_frontend.py::TestFrontendStructure::test_01_index_html_structure PASSED [  0%]\nbackend/tests/e2e/test_frontend.py::TestFrontendStructure::test_02_preferences_html_structure PASSED [  0%]\nbackend/tests/e2e/test_pdf_export.py::TestPDFExport::test_pdf_export_functionality FAILED [  1%]\nbackend/tests/integration/test_comprehensive.py::TestComprehensive::test_all_chapters_generated FAILED [  1%]\nbackend/tests/integration/test_comprehensive.py::TestComprehensive::test_energy_label_logic PASSED [  2%]\nbackend/tests/integration/test_comprehensive.py::TestComprehensive::test_kpi_calculations_robustness PASSED [  2%]\nbackend/tests/integration/test_consistency.py::TestChapterConsistency::test_bedroom_logic PASSED [  3%]\nbackend/tests/integration/test_consistency.py::TestChapterConsistency::test_content_text_consistency PASSED [  3%]\nbackend/tests/integration/test_consistency.py::TestChapterConsistency::test_energy_label_consistency PASSED [  4%]\nbackend/tests/integration/test_consistency.py::TestChapterConsistency::test_living_area_consistency PASSED [  4%]\nbackend/tests/integration/test_consistency.py::TestChapterConsistency::test_price_consistency PASSED [  5%]\nbackend/tests/integration/test_consistency.py::TestChapterConsistency::test_sqm_price_consistency PASSED [  5%]\nbackend/tests/integration/test_docker_sync.py::TestDockerSync::test_ensure_latest_docker_build PASSED [  6%]\nbackend/tests/integration/test_integration.py::TestIntegration::test_full_flow_with_paste FAILED [  6%]\nbackend/tests/integration/test_integration_fixtures.py::TestFixturesOutput::test_fixtures_generation \nbackend/tests/integration/test_integration_fixtures.py::TestFixturesOutput::test_fixtures_generation PASSED [  7%]\nbackend/tests/quality/test_audit_codebase.py::test_audit_codebase_for_mocks_and_hardcoded_items PASSED [  7%]\nbackend/tests/quality/test_dynamism.py::TestDynamism::test_dynamism_score_generation PASSED [  8%]\nbackend/tests/test_verify_consistency.py::test_consistency_check_happy_path FAILED [  8%]\nbackend/tests/test_verify_consistency.py::test_consistency_check_detects_price_mismatch PASSED [  9%]\nbackend/tests/test_verify_consistency.py::test_consistency_check_detects_label_mismatch PASSED [  9%]\nbackend/tests/unit/test_ai_interpretation.py::TestAiInterpretation::test_all_chapters_generation \nbackend/tests/unit/test_ai_interpretation.py::TestAiInterpretation::test_all_chapters_generation PASSED [ 10%]\nbackend/tests/unit/test_ai_interpretation.py::TestAiInterpretation::test_html_structure_consistency PASSED [ 10%]\nbackend/tests/unit/test_ai_interpretation.py::TestAiInterpretation::test_scenario_luxury_villa PASSED [ 11%]\nbackend/tests/unit/test_ai_interpretation.py::TestAiInterpretation::test_scenario_modern_eco_house PASSED [ 11%]\nbackend/tests/unit/test_ai_interpretation.py::TestAiInterpretation::test_scenario_old_fixer_upper PASSED [ 12%]\nbackend/tests/unit/test_ai_refactor.py::test_provider_factory_listing PASSED [ 12%]\nbackend/tests/unit/test_ai_refactor.py::test_provider_factory_creation_with_model PASSED [ 13%]\nbackend/tests/unit/test_ai_refactor.py::test_api_ai_models_endpoint PASSED [ 13%]\nbackend/tests/unit/test_ai_refactor.py::test_preferences_sync_with_ai_settings PASSED [ 14%]\nbackend/tests/unit/test_api_endpoints.py::TestApiEndpoints::test_create_run_defaults FAILED [ 14%]\nbackend/tests/unit/test_api_endpoints.py::TestApiEndpoints::test_get_nonexistent_run FAILED [ 15%]\nbackend/tests/unit/test_api_endpoints.py::TestApiEndpoints::test_health_check FAILED [ 15%]\nbackend/tests/unit/test_api_endpoints.py::TestApiEndpoints::test_preferences_api PASSED [ 16%]\nbackend/tests/unit/test_api_endpoints.py::TestApiEndpoints::test_start_run_updates_status FAILED [ 16%]\nbackend/tests/unit/test_async_pipeline.py::TestAsyncPipeline::test_start_run_returns_immediately FAILED [ 17%]\nbackend/tests/unit/test_async_pipeline.py::TestAsyncPipeline::test_status_polling_endpoint_exists FAILED [ 17%]\nbackend/tests/unit/test_async_pipeline.py::TestAsyncPipeline::test_status_polling_progress_calculation FAILED [ 18%]\nbackend/tests/unit/test_async_pipeline.py::TestAsyncPipeline::test_status_endpoint_404_for_nonexistent_run FAILED [ 18%]\nbackend/tests/unit/test_async_pipeline.py::TestAsyncPipeline::test_pipeline_runs_in_background FAILED [ 19%]\nbackend/tests/unit/test_async_pipeline.py::TestAsyncPipeline::test_multiple_concurrent_pipelines FAILED [ 19%]\nbackend/tests/unit/test_async_pipeline.py::TestThreadExecutor::test_executor_exists FAILED [ 20%]\nbackend/tests/unit/test_async_pipeline.py::TestThreadExecutor::test_simulate_pipeline_callable PASSED [ 20%]\nbackend/tests/unit/test_async_pipeline.py::TestBackwardCompatibility::test_report_endpoint_still_works FAILED [ 20%]\nbackend/tests/unit/test_async_pipeline.py::TestBackwardCompatibility::test_create_run_endpoint_unchanged FAILED [ 21%]\nbackend/tests/unit/test_chapter_0_logic.py::TestChapter0Logic::test_address_cleanup FAILED [ 21%]\nbackend/tests/unit/test_chapter_0_logic.py::TestChapter0Logic::test_robotic_currency FAILED [ 22%]\nbackend/tests/unit/test_chapter_0_logic.py::TestChapter0Logic::test_maintenance_consistency PASSED [ 22%]\nbackend/tests/unit/test_chapter_routines.py::TestChapterRoutines::test_chapter_file_correspondence \nbackend/tests/unit/test_chapter_routines.py::TestChapterRoutines::test_chapter_file_correspondence PASSED [ 23%]\nbackend/tests/unit/test_chapter_routines.py::TestChapterRoutines::test_unique_layout_per_page FAILED [ 23%]\nbackend/tests/unit/test_chapter_routines.py::TestChapterRoutines::test_z_generate_design_compliance_report FAILED [ 24%]\nbackend/tests/unit/test_chapters.py::TestChapters::test_chapter_generation PASSED [ 24%]\nbackend/tests/unit/test_chapters.py::TestChapters::test_chapter_registry PASSED [ 25%]\nbackend/tests/unit/test_complex_parsing.py::TestComplexParsing::test_no_classes_layout PASSED [ 25%]\nbackend/tests/unit/test_config_api.py::test_get_full_config PASSED       [ 26%]\nbackend/tests/unit/test_config_api.py::test_get_config_section PASSED    [ 26%]\nbackend/tests/unit/test_config_api.py::test_get_config_section_not_found PASSED [ 27%]\nbackend/tests/unit/test_config_api.py::test_get_config_value PASSED      [ 27%]\nbackend/tests/unit/test_config_api.py::test_update_config_bulk PASSED    [ 28%]\nbackend/tests/unit/test_config_api.py::test_update_config_value PASSED   [ 28%]\nbackend/tests/unit/test_config_api.py::test_update_config_invalid_section PASSED [ 29%]\nbackend/tests/unit/test_config_api.py::test_update_config_invalid_key PASSED [ 29%]\nbackend/tests/unit/test_display_units.py::TestDisplayUnits::test_derived_metrics_consistency FAILED [ 30%]\nbackend/tests/unit/test_display_units.py::TestDisplayUnits::test_no_duplicate_m2_in_hero FAILED [ 30%]\nbackend/tests/unit/test_display_units.py::TestDisplayUnits::test_no_duplicate_m2_in_metrics FAILED [ 31%]\nbackend/tests/unit/test_display_units.py::TestDisplayUnits::test_price_m2_calculation_accuracy FAILED [ 31%]\nbackend/tests/unit/test_domain_models.py::TestDomainModels::test_chapter_output_flexibility PASSED [ 32%]\nbackend/tests/unit/test_domain_models.py::TestDomainModels::test_property_core_defaults PASSED [ 32%]\nbackend/tests/unit/test_domain_models.py::TestDomainModels::test_ui_component_structure PASSED [ 33%]\nbackend/tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard \nbackend/tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard PASSED [ 33%]\nbackend/tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_chapter_titles FAILED [ 34%]\nbackend/tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_dynamic_intelligence_integration FAILED [ 34%]\nbackend/tests/unit/test_explore_insights.py::TestExploreInsights::test_capture_chapter_insights FAILED [ 35%]\nbackend/tests/unit/test_frontend_compatibility.py::TestRegression::test_chapter_data_bridging FAILED [ 35%]\nbackend/tests/unit/test_frontend_compatibility.py::TestRegression::test_chapter_id_present FAILED [ 36%]\nbackend/tests/unit/test_image_upload.py::TestImageUpload::test_upload_endpoint_exists PASSED [ 36%]\nbackend/tests/unit/test_image_upload.py::TestImageUpload::test_upload_valid_image PASSED [ 37%]\nbackend/tests/unit/test_image_upload.py::TestImageUpload::test_upload_jpg_image PASSED [ 37%]\nbackend/tests/unit/test_image_upload.py::TestImageUpload::test_upload_non_image_file_rejected PASSED [ 38%]\nbackend/tests/unit/test_image_upload.py::TestImageUpload::test_upload_oversized_image_rejected PASSED [ 38%]\nbackend/tests/unit/test_image_upload.py::TestImageUpload::test_uploaded_file_is_accessible PASSED [ 39%]\nbackend/tests/unit/test_image_upload.py::TestImageUpload::test_upload_generates_unique_filenames PASSED [ 39%]\nbackend/tests/unit/test_image_upload.py::TestImageUpload::test_upload_preserves_file_extension PASSED [ 40%]\nbackend/tests/unit/test_image_upload.py::TestImageUpload::test_upload_directory_exists PASSED [ 40%]\nbackend/tests/unit/test_image_upload.py::TestImageUpload::test_upload_handles_special_characters_in_filename PASSED [ 40%]\nbackend/tests/unit/test_image_upload.py::TestImageUploadIntegration::test_paste_with_media_urls FAILED [ 41%]\nbackend/tests/unit/test_image_upload.py::TestImageUploadSecurity::test_upload_without_authentication PASSED [ 41%]\nbackend/tests/unit/test_image_upload.py::TestImageUploadSecurity::test_path_traversal_prevention PASSED [ 42%]\nbackend/tests/unit/test_intelligence.py::TestIntelligenceEngine::test_chapter_0_executive_summary FAILED [ 42%]\nbackend/tests/unit/test_intelligence.py::TestIntelligenceEngine::test_chapter_4_energy_logic PASSED [ 43%]\nbackend/tests/unit/test_intelligence.py::TestIntelligenceEngine::test_generate_chapter_narrative_structure PASSED [ 43%]\nbackend/tests/unit/test_intelligence.py::TestIntelligenceEngine::test_parse_int_helper PASSED [ 44%]\nbackend/tests/unit/test_modern_chapter.py::TestModernChapter::test_chapter_structure_modern FAILED [ 44%]\nbackend/tests/unit/test_modern_chapter.py::TestModernChapter::test_energy_chapter_layout FAILED [ 45%]\nbackend/tests/unit/test_modern_design_compliance.py::TestModernDesignCompliance::test_all_chapters_exist FAILED [ 45%]\nbackend/tests/unit/test_modern_design_compliance.py::TestModernDesignCompliance::test_data_integrity_no_placeholders FAILED [ 46%]\nbackend/tests/unit/test_modern_design_compliance.py::TestModernDesignCompliance::test_enriched_by_ai_check FAILED [ 46%]\nbackend/tests/unit/test_modern_design_compliance.py::TestModernDesignCompliance::test_modern_4k_structure_compliance FAILED [ 47%]\nbackend/tests/unit/test_ollama_integration.py::TestOllamaIntegration::test_ai_narrative_generation_failure_fallback PASSED [ 47%]\nbackend/tests/unit/test_ollama_integration.py::TestOllamaIntegration::test_ai_narrative_generation_success FAILED [ 48%]\nbackend/tests/unit/test_ollama_integration.py::TestOllamaIntegration::test_prompt_structure_contains_preferences PASSED [ 48%]\nbackend/tests/unit/test_ollama_integration.py::TestOllamaIntegration::test_provider_injection PASSED [ 49%]\nbackend/tests/unit/test_parser.py::TestParser::test_bedroom_extraction_from_rooms PASSED [ 49%]\nbackend/tests/unit/test_parser.py::TestParser::test_comprehensive_field_extraction PASSED [ 50%]\nbackend/tests/unit/test_parser.py::TestParser::test_cross_validation_bedrooms_vs_rooms PASSED [ 50%]\nbackend/tests/unit/test_parser.py::TestParser::test_data_quality_report PASSED [ 51%]\nbackend/tests/unit/test_parser.py::TestParser::test_illogical_data_validation PASSED [ 51%]\nbackend/tests/unit/test_parser.py::TestParser::test_parse_real_fixture PASSED [ 52%]\nbackend/tests/unit/test_parser.py::TestParser::test_parse_sample PASSED  [ 52%]\nbackend/tests/unit/test_parser_edge_cases.py::TestParserEdgeCases::test_navigation_text_address_bug PASSED [ 53%]\nbackend/tests/unit/test_parser_edge_cases.py::TestParserEdgeCases::test_photo_count_as_rooms_bug PASSED [ 53%]\nbackend/tests/unit/test_parser_edge_cases.py::TestParserEdgeCases::test_suspicious_room_count_correction PASSED [ 54%]\nbackend/tests/unit/test_parser_edge_cases.py::TestParserEdgeCases::test_duplicate_m2_display_fix PASSED [ 54%]\nbackend/tests/unit/test_parser_edge_cases_additional.py::test_address_blocklist_ignored PASSED [ 55%]\nbackend/tests/unit/test_parser_edge_cases_additional.py::test_bedroom_capping PASSED [ 55%]\nbackend/tests/unit/test_preferences_compliance.py::TestPreferencesCompliance::test_marcel_petra_preferences_match FAILED [ 56%]\nbackend/tests/unit/test_preferences_compliance.py::TestPreferencesCompliance::test_missing_preferences_handling PASSED [ 56%]\nbackend/tests/unit/test_preferenties_vergelijking.py::TestPreferentiesVergelijking::test_vergelijking_logica PASSED [ 57%]\nbackend/tests/unit/test_provider_factory.py::TestProviderRegistry::test_list_providers_returns_all_registered PASSED [ 57%]\nbackend/tests/unit/test_provider_factory.py::TestProviderRegistry::test_registry_contains_correct_classes PASSED [ 58%]\nbackend/tests/unit/test_provider_factory.py::TestProviderRegistry::test_register_new_provider PASSED [ 58%]\nbackend/tests/unit/test_provider_factory.py::TestProviderFactory::test_create_ollama_provider_default PASSED [ 59%]\nbackend/tests/unit/test_provider_factory.py::TestProviderFactory::test_create_ollama_provider_custom_url PASSED [ 59%]\nbackend/tests/unit/test_provider_factory.py::TestProviderFactory::test_create_ollama_provider_custom_timeout PASSED [ 60%]\nbackend/tests/unit/test_provider_factory.py::TestProviderFactory::test_create_openai_provider_with_api_key PASSED [ 60%]\nbackend/tests/unit/test_provider_factory.py::TestProviderFactory::test_create_openai_provider_without_api_key_raises_error PASSED [ 60%]\nbackend/tests/unit/test_provider_factory.py::TestProviderFactory::test_create_anthropic_provider_with_api_key PASSED [ 61%]\nbackend/tests/unit/test_provider_factory.py::TestProviderFactory::test_create_anthropic_provider_without_api_key_raises_error PASSED [ 61%]\nbackend/tests/unit/test_provider_factory.py::TestProviderFactory::test_create_gemini_provider_with_api_key PASSED [ 62%]\nbackend/tests/unit/test_provider_factory.py::TestProviderFactory::test_create_gemini_provider_without_api_key_raises_error PASSED [ 62%]\nbackend/tests/unit/test_provider_factory.py::TestProviderFactory::test_create_unknown_provider_raises_error PASSED [ 63%]\nbackend/tests/unit/test_provider_factory.py::TestProviderFactory::test_create_provider_with_extra_kwargs PASSED [ 63%]\nbackend/tests/unit/test_provider_factory.py::TestProviderFactory::test_create_all_providers_with_valid_config PASSED [ 64%]\nbackend/tests/unit/test_provider_factory.py::TestProviderFactory::test_provider_factory_respects_timeout_parameter PASSED [ 64%]\nbackend/tests/unit/test_provider_factory.py::TestFactoryRegistryIntegration::test_factory_uses_registry_for_provider_lookup PASSED [ 65%]\nbackend/tests/unit/test_provider_factory.py::TestFactoryRegistryIntegration::test_custom_provider_can_be_registered_and_created PASSED [ 65%]\nbackend/tests/unit/test_provider_factory.py::TestFactoryRegistryIntegration::test_all_registered_providers_can_be_created PASSED [ 66%]\nbackend/tests/unit/test_provider_factory.py::TestProviderFactoryErrorHandling::test_none_provider_name_raises_error PASSED [ 66%]\nbackend/tests/unit/test_provider_factory.py::TestProviderFactoryErrorHandling::test_empty_provider_name_raises_error PASSED [ 67%]\nbackend/tests/unit/test_provider_factory.py::TestProviderFactoryErrorHandling::test_case_sensitive_provider_names PASSED [ 67%]\nbackend/tests/unit/test_provider_factory.py::TestProviderFactoryErrorHandling::test_helpful_error_message_lists_available_providers PASSED [ 68%]\nbackend/tests/unit/test_providers.py::TestOllamaProvider::test_ollama_initialization_default PASSED [ 68%]\nbackend/tests/unit/test_providers.py::TestOllamaProvider::test_ollama_initialization_custom_url PASSED [ 69%]\nbackend/tests/unit/test_providers.py::TestOllamaProvider::test_ollama_initialization_env_var PASSED [ 69%]\nbackend/tests/unit/test_providers.py::TestOllamaProvider::test_ollama_initialization_docker_env PASSED [ 70%]\nbackend/tests/unit/test_providers.py::TestOllamaProvider::test_ollama_name_property PASSED [ 70%]\nbackend/tests/unit/test_providers.py::TestOllamaProvider::test_ollama_list_models_success PASSED [ 71%]\nbackend/tests/unit/test_providers.py::TestOllamaProvider::test_ollama_list_models_http_error PASSED [ 71%]\nbackend/tests/unit/test_providers.py::TestOllamaProvider::test_ollama_list_models_connection_error PASSED [ 72%]\nbackend/tests/unit/test_providers.py::TestOllamaProvider::test_ollama_generate_success PASSED [ 72%]\nbackend/tests/unit/test_providers.py::TestOllamaProvider::test_ollama_generate_timeout PASSED [ 73%]\nbackend/tests/unit/test_providers.py::TestOllamaProvider::test_ollama_check_health_success PASSED [ 73%]\nbackend/tests/unit/test_providers.py::TestOllamaProvider::test_ollama_check_health_failure PASSED [ 74%]\nbackend/tests/unit/test_providers.py::TestOpenAIProvider::test_openai_initialization_with_key PASSED [ 74%]\nbackend/tests/unit/test_providers.py::TestOpenAIProvider::test_openai_initialization_from_env PASSED [ 75%]\nbackend/tests/unit/test_providers.py::TestOpenAIProvider::test_openai_initialization_no_key_raises_error PASSED [ 75%]\nbackend/tests/unit/test_providers.py::TestOpenAIProvider::test_openai_name_property PASSED [ 76%]\nbackend/tests/unit/test_providers.py::TestOpenAIProvider::test_openai_list_models PASSED [ 76%]\nbackend/tests/unit/test_providers.py::TestOpenAIProvider::test_openai_generate_success PASSED [ 77%]\nbackend/tests/unit/test_providers.py::TestOpenAIProvider::test_openai_generate_with_json_mode PASSED [ 77%]\nbackend/tests/unit/test_providers.py::TestOpenAIProvider::test_openai_generate_error_handling PASSED [ 78%]\nbackend/tests/unit/test_providers.py::TestOpenAIProvider::test_openai_check_health_success FAILED [ 78%]\nbackend/tests/unit/test_providers.py::TestOpenAIProvider::test_openai_check_health_failure FAILED [ 79%]\nbackend/tests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_initialization_with_key PASSED [ 79%]\nbackend/tests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_initialization_custom_timeout PASSED [ 80%]\nbackend/tests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_name_property PASSED [ 80%]\nbackend/tests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_list_models PASSED [ 80%]\nbackend/tests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_generate_success PASSED [ 81%]\nbackend/tests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_generate_with_json_mode PASSED [ 81%]\nbackend/tests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_generate_timeout_error PASSED [ 82%]\nbackend/tests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_check_health_success PASSED [ 82%]\nbackend/tests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_check_health_failure PASSED [ 83%]\nbackend/tests/unit/test_providers.py::TestGeminiProvider::test_gemini_initialization_with_key PASSED [ 83%]\nbackend/tests/unit/test_providers.py::TestGeminiProvider::test_gemini_initialization_from_google_env PASSED [ 84%]\nbackend/tests/unit/test_providers.py::TestGeminiProvider::test_gemini_initialization_from_gemini_env PASSED [ 84%]\nbackend/tests/unit/test_providers.py::TestGeminiProvider::test_gemini_initialization_no_key_raises_error PASSED [ 85%]\nbackend/tests/unit/test_providers.py::TestGeminiProvider::test_gemini_name_property PASSED [ 85%]\nbackend/tests/unit/test_providers.py::TestGeminiProvider::test_gemini_list_models PASSED [ 86%]\nbackend/tests/unit/test_providers.py::TestGeminiProvider::test_gemini_generate_success PASSED [ 86%]\nbackend/tests/unit/test_providers.py::TestGeminiProvider::test_gemini_generate_with_json_mode PASSED [ 87%]\nbackend/tests/unit/test_providers.py::TestGeminiProvider::test_gemini_generate_error_handling PASSED [ 87%]\nbackend/tests/unit/test_providers.py::TestGeminiProvider::test_gemini_check_health_success FAILED [ 88%]\nbackend/tests/unit/test_providers.py::TestGeminiProvider::test_gemini_check_health_no_api_key PASSED [ 88%]\nbackend/tests/unit/test_providers.py::TestGeminiProvider::test_gemini_check_health_failure FAILED [ 89%]\nbackend/tests/unit/test_providers.py::TestProviderInterface::test_all_providers_implement_interface PASSED [ 89%]\nbackend/tests/unit/test_providers.py::TestProviderInterface::test_all_providers_have_name_property PASSED [ 90%]\nbackend/tests/unit/test_utils.py::TestParsingUtilities::test_parse_float_invalid PASSED [ 90%]\nbackend/tests/unit/test_utils.py::TestParsingUtilities::test_parse_float_valid PASSED [ 91%]\nbackend/tests/unit/test_utils.py::TestParsingUtilities::test_parse_int_custom_default PASSED [ 91%]\nbackend/tests/unit/test_utils.py::TestParsingUtilities::test_parse_int_formatted_numbers PASSED [ 92%]\nbackend/tests/unit/test_utils.py::TestParsingUtilities::test_parse_int_invalid_inputs PASSED [ 92%]\nbackend/tests/unit/test_utils.py::TestParsingUtilities::test_parse_int_valid_numbers PASSED [ 93%]\nbackend/tests/unit/test_utils.py::TestValidationUtilities::test_validate_bedrooms_explicit_count PASSED [ 93%]\nbackend/tests/unit/test_utils.py::TestValidationUtilities::test_validate_bedrooms_minimum PASSED [ 94%]\nbackend/tests/unit/test_utils.py::TestValidationUtilities::test_validate_bedrooms_normal_range PASSED [ 94%]\nbackend/tests/unit/test_utils.py::TestValidationUtilities::test_validate_bedrooms_upper_bound PASSED [ 95%]\nbackend/tests/unit/test_utils.py::TestValidationUtilities::test_validate_living_area_bounds PASSED [ 95%]\nbackend/tests/unit/test_utils.py::TestValidationUtilities::test_validate_living_area_normal PASSED [ 96%]\nbackend/tests/unit/test_utils.py::TestSafetyUtilities::test_ensure_grid_layout_existing PASSED [ 96%]\nbackend/tests/unit/test_utils.py::TestSafetyUtilities::test_ensure_grid_layout_missing PASSED [ 97%]\nbackend/tests/unit/test_utils.py::TestSafetyUtilities::test_safe_get_existing_key PASSED [ 97%]\nbackend/tests/unit/test_utils.py::TestSafetyUtilities::test_safe_get_missing_key PASSED [ 98%]\nbackend/tests/unit/test_utils.py::TestSafetyUtilities::test_safe_get_none_value PASSED [ 98%]\nbackend/tests/unit/test_utils.py::TestEdgeCases::test_parse_int_extreme_values PASSED [ 99%]\nbackend/tests/unit/test_utils.py::TestEdgeCases::test_validate_bedrooms_edge_cases PASSED [ 99%]\nbackend/tests/unit/test_utils.py::TestEdgeCases::test_validate_living_area_warnings PASSED [100%]\n\n=================================== FAILURES ===================================\n_________________ TestPDFExport.test_pdf_export_functionality __________________\nbackend/tests/e2e/test_pdf_export.py:134: in test_pdf_export_functionality\n    self.assertEqual(response.headers[\"content-type\"], \"application/pdf\")\nE   AssertionError: 'text/html; charset=utf-8' != 'application/pdf'\nE   - text/html; charset=utf-8\nE   + application/pdf\n________________ TestComprehensive.test_all_chapters_generated _________________\nbackend/tests/integration/test_comprehensive.py:37: in test_all_chapters_generated\n    self.assertTrue(len(content) > 10, f\"Chapter {i} content too short\")\nE   AssertionError: False is not true : Chapter 13 content too short\n__________________ TestIntegration.test_full_flow_with_paste ___________________\nbackend/tests/integration/test_integration.py:36: in test_full_flow_with_paste\n    self.assertEqual(resp.status_code, 200)\nE   AssertionError: 405 != 200\n----------------------------- Captured stdout call -----------------------------\n\n[Test] Starting Run...\n______________________ test_consistency_check_happy_path _______________________\nbackend/tests/test_verify_consistency.py:30: in test_consistency_check_happy_path\n    assert len(mismatches) == 0, f\"Expected 0 mismatches, found: {mismatches}\"\nE   AssertionError: Expected 0 mismatches, found: [{'field': 'balcony', 'status': 'mismatch', 'source': 'Text Scan', 'parsed': 'Ja', 'message': \"Waarde 'Ja' niet gevonden als losstaand woord.\"}]\nE   assert 1 == 0\nE    +  where 1 = len([{'field': 'balcony', 'message': \"Waarde 'Ja' niet gevonden als losstaand woord.\", 'parsed': 'Ja', 'source': 'Text Scan', ...}])\n------------------------------ Captured log call -------------------------------\nWARNING  backend.consistency:consistency.py:135 Consistency Issues: 1 fields mismatch.\n__________________ TestApiEndpoints.test_create_run_defaults ___________________\nbackend/tests/unit/test_api_endpoints.py:18: in test_create_run_defaults\n    self.assertEqual(resp.status_code, 200)\nE   AssertionError: 405 != 200\n__________________ TestApiEndpoints.test_get_nonexistent_run ___________________\nbackend/tests/unit/test_api_endpoints.py:26: in test_get_nonexistent_run\n    self.assertEqual(resp.status_code, 404)\nE   AssertionError: 200 != 404\n______________________ TestApiEndpoints.test_health_check ______________________\nbackend/tests/unit/test_api_endpoints.py:59: in test_health_check\n    data = resp.json()\n           ^^^^^^^^^^^\n../../Library/Python/3.11/lib/python/site-packages/httpx/_models.py:832: in json\n    return jsonlib.loads(self.content, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py:346: in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/decoder.py:337: in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/decoder.py:355: in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\nE   json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\n________________ TestApiEndpoints.test_start_run_updates_status ________________\nbackend/tests/unit/test_api_endpoints.py:32: in test_start_run_updates_status\n    run_id = create_resp.json()[\"run_id\"]\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   KeyError: 'run_id'\n_____________ TestAsyncPipeline.test_start_run_returns_immediately _____________\nbackend/tests/unit/test_async_pipeline.py:40: in test_start_run_returns_immediately\n    assert create_response.status_code == 200\nE   assert 405 == 200\nE    +  where 405 = <Response [405 Method Not Allowed]>.status_code\n____________ TestAsyncPipeline.test_status_polling_endpoint_exists _____________\nbackend/tests/unit/test_async_pipeline.py:61: in test_status_polling_endpoint_exists\n    run_id = create_response.json()[\"run_id\"]\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   KeyError: 'run_id'\n__________ TestAsyncPipeline.test_status_polling_progress_calculation __________\nbackend/tests/unit/test_async_pipeline.py:80: in test_status_polling_progress_calculation\n    run_id = create_response.json()[\"run_id\"]\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   KeyError: 'run_id'\n________ TestAsyncPipeline.test_status_endpoint_404_for_nonexistent_run ________\nbackend/tests/unit/test_async_pipeline.py:96: in test_status_endpoint_404_for_nonexistent_run\n    assert response.status_code == 404\nE   assert 200 == 404\nE    +  where 200 = <Response [200 OK]>.status_code\n______________ TestAsyncPipeline.test_pipeline_runs_in_background ______________\nbackend/tests/unit/test_async_pipeline.py:105: in test_pipeline_runs_in_background\n    run_id = create_response.json()[\"run_id\"]\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   KeyError: 'run_id'\n_____________ TestAsyncPipeline.test_multiple_concurrent_pipelines _____________\nbackend/tests/unit/test_async_pipeline.py:141: in test_multiple_concurrent_pipelines\n    run_ids.append(response.json()[\"run_id\"])\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   KeyError: 'run_id'\n___________________ TestThreadExecutor.test_executor_exists ____________________\nbackend/tests/unit/test_async_pipeline.py:162: in test_executor_exists\n    assert executor._max_workers == settings.pipeline.max_workers\nE   AssertionError: assert 10 == 2\nE    +  where 10 = <concurrent.futures.thread.ThreadPoolExecutor object at 0x1092b0f50>._max_workers\nE    +  and   2 = PipelineSettings(max_workers=2, image_max_size_mb=10, poll_interval_ms=2000).max_workers\nE    +    where PipelineSettings(max_workers=2, image_max_size_mb=10, poll_interval_ms=2000) = AppSettings(ai=AISettings(provider='gemini', model='gemini-3-fast', timeout=30, fallback_enabled=True, openai_api_key=None, anthropic_api_key=None, gemini_api_key=None, ollama_base_url=None), market=MarketSettings(avg_price_m2=6000, energy_label_scores={'A': 95, 'B': 80, 'C': 65, 'D': 50, 'E': 35, 'F': 20, 'G': 10}), fit_score=FitScoreSettings(base=0.5, completeness_bonus=0.2, energy_bonus=0.15), validation=ValidationSettings(max_bedrooms=15, max_bathrooms=10, max_total_rooms=30, min_living_area=10, max_living_area=2000, min_build_year=1500, max_build_year=2030), pipeline=PipelineSettings(max_workers=2, image_max_size_mb=10, poll_interval_ms=2000), preferences=UserPreferencesSettings(marcel_keywords=['glasvezel', 'zonnepanelen', 'garage', 'laadpaal', '1930'], marcel_tech_weight=0.4, marcel_infrastructure_weight=0.3, marcel_energy_weight=0.3, marcel_hidden_priorities=['bouwjaar', 'dakisolatie'], petra_keywords=['karakteristiek', 'sfeer', 'tuin', 'bad', 'licht'], petra_atmosphere_weight=0.4, petra_comfort_weight=0.3, petra_finish_weight=0.3, petra_hidden_priorities=['afwerking', 'badkamer']), chapters=ChapterSettings(titles={'0': 'Introductie & Samenvatting', '1': 'Algemene Woningkenmerken', '2': 'Matchanalyse Marcel & Petra', '3': 'Bouwkundige Staat', '4': 'Energie & Duurzaamheid', '5': 'Indeling & Ruimtegebruik', '6': 'Onderhoud & Afwerking', '7': 'Tuin & Buitenruimte', '8': 'Parkeren & Bereikbaarheid', '9': 'Juridische Aspecten', '10': 'Financi\u00eble Analyse', '11': 'Marktpositie', '12': 'Advies & Conclusie'}), database_url='/Users/marcelkurvers/Development/funda-app/data/local_app.db').pipeline\n__________ TestBackwardCompatibility.test_report_endpoint_still_works __________\nbackend/tests/unit/test_async_pipeline.py:179: in test_report_endpoint_still_works\n    run_id = create_response.json()[\"run_id\"]\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   KeyError: 'run_id'\n_________ TestBackwardCompatibility.test_create_run_endpoint_unchanged _________\nbackend/tests/unit/test_async_pipeline.py:200: in test_create_run_endpoint_unchanged\n    assert response.status_code == 200\nE   assert 405 == 200\nE    +  where 405 = <Response [405 Method Not Allowed]>.status_code\n____________________ TestChapter0Logic.test_address_cleanup ____________________\nbackend/tests/unit/test_chapter_0_logic.py:22: in test_address_cleanup\n    assert \"aan dit object\" in intro or \"aan dit adres\" in intro or \"locatie\" in intro or \"van dit object\" in intro\nE   AssertionError: assert ('aan dit object' in 'Welkom bij de strategische analyse van de Mijn Huis. Dit rapport combineert harde data met AI-gestuurde interpretaties om een compleet beeld van uw potenti\u00eble aankoop te vormen.' or 'aan dit adres' in 'Welkom bij de strategische analyse van de Mijn Huis. Dit rapport combineert harde data met AI-gestuurde interpretaties om een compleet beeld van uw potenti\u00eble aankoop te vormen.' or 'locatie' in 'Welkom bij de strategische analyse van de Mijn Huis. Dit rapport combineert harde data met AI-gestuurde interpretaties om een compleet beeld van uw potenti\u00eble aankoop te vormen.' or 'van dit object' in 'Welkom bij de strategische analyse van de Mijn Huis. Dit rapport combineert harde data met AI-gestuurde interpretaties om een compleet beeld van uw potenti\u00eble aankoop te vormen.')\n___________________ TestChapter0Logic.test_robotic_currency ____________________\nbackend/tests/unit/test_chapter_0_logic.py:38: in test_robotic_currency\n    assert \"geen directe investering\" in html or \"minimale investering\" in html\nE   assert ('geen directe investering' in '\\n        <div class=\"mag-layout-container\">\\n            \\n            <div class=\"mag-provenance-header\">\\n                <div class=\"prov-badge conf-high\">\\n                    <ion-icon name=\"shield-checkmark\"></ion-icon>\\n                    AI Vertrouwen: HIGH\\n                </div>\\n                <div class=\"prov-details\">\\n                    <span><ion-icon name=\"hardware-chip\"></ion-icon> v5.0-Deterministic</span>\\n                    <span><ion-icon name=\"time\"></ion-icon> </span>\\n                </div>\\n            </div>\\n            \\n            \\n            <div class=\"mag-intro-section\">\\n                <div class=\"mag-lead-text\">\\n                    Welkom bij de strategische analyse van de Kalverstraat 1. Dit rapport combineert harde data met AI-gestuurde interpretaties om een compleet beeld van uw potenti\u00eble aankoop te vormen.\\n                </div>\\n            </div>\\n\\n            <div class=\"mag-split-grid\">\\n                <div class=\"mag-col-text\">\\n                    \\n            <div class=\"mag-domain-grid\">\\n                <h4 class=\"mag-section-header\">Domein Variabelen Check</h4>\\n                <div class=\"mag-var-container\">\\n      ...n></div>\\n                    <span class=\"mag-feature-text\">Gunstige prijsstelling</span>\\n                </div>\\n            \\n                </div>\\n            </div>\\n            \\n                    \\n            <div class=\"mag-widget-card\">\\n                <h4 class=\"mag-widget-title text-amber-700\"><ion-icon name=\"warning\"></ion-icon> Aandachtspunten</h4>\\n                <div class=\"mag-feature-grid\">\\n                <div class=\"mag-feature-item warning\">\\n                    <div class=\"mag-icon-box warning\"><ion-icon name=\"alert-circle\"></ion-icon></div>\\n                    <span class=\"mag-feature-text\">Plan een tweede bezichtiging met een bouwkundige.</span>\\n                </div>\\n                \\n                <div class=\"mag-feature-item warning\">\\n                    <div class=\"mag-icon-box warning\"><ion-icon name=\"alert-circle\"></ion-icon></div>\\n                    <span class=\"mag-feature-text\">Controleer het bestemmingsplan.</span>\\n                </div>\\n                </div>\\n            </div>\\n            \\n                    <div id=\"mag-dynamic-sidebar-target\"></div> \\n                </div>\\n\\n            </div>\\n        </div>\\n        ' or 'minimale investering' in '\\n        <div class=\"mag-layout-container\">\\n            \\n            <div class=\"mag-provenance-header\">\\n                <div class=\"prov-badge conf-high\">\\n                    <ion-icon name=\"shield-checkmark\"></ion-icon>\\n                    AI Vertrouwen: HIGH\\n                </div>\\n                <div class=\"prov-details\">\\n                    <span><ion-icon name=\"hardware-chip\"></ion-icon> v5.0-Deterministic</span>\\n                    <span><ion-icon name=\"time\"></ion-icon> </span>\\n                </div>\\n            </div>\\n            \\n            \\n            <div class=\"mag-intro-section\">\\n                <div class=\"mag-lead-text\">\\n                    Welkom bij de strategische analyse van de Kalverstraat 1. Dit rapport combineert harde data met AI-gestuurde interpretaties om een compleet beeld van uw potenti\u00eble aankoop te vormen.\\n                </div>\\n            </div>\\n\\n            <div class=\"mag-split-grid\">\\n                <div class=\"mag-col-text\">\\n                    \\n            <div class=\"mag-domain-grid\">\\n                <h4 class=\"mag-section-header\">Domein Variabelen Check</h4>\\n                <div class=\"mag-var-container\">\\n      ...n></div>\\n                    <span class=\"mag-feature-text\">Gunstige prijsstelling</span>\\n                </div>\\n            \\n                </div>\\n            </div>\\n            \\n                    \\n            <div class=\"mag-widget-card\">\\n                <h4 class=\"mag-widget-title text-amber-700\"><ion-icon name=\"warning\"></ion-icon> Aandachtspunten</h4>\\n                <div class=\"mag-feature-grid\">\\n                <div class=\"mag-feature-item warning\">\\n                    <div class=\"mag-icon-box warning\"><ion-icon name=\"alert-circle\"></ion-icon></div>\\n                    <span class=\"mag-feature-text\">Plan een tweede bezichtiging met een bouwkundige.</span>\\n                </div>\\n                \\n                <div class=\"mag-feature-item warning\">\\n                    <div class=\"mag-icon-box warning\"><ion-icon name=\"alert-circle\"></ion-icon></div>\\n                    <span class=\"mag-feature-text\">Controleer het bestemmingsplan.</span>\\n                </div>\\n                </div>\\n            </div>\\n            \\n                    <div id=\"mag-dynamic-sidebar-target\"></div> \\n                </div>\\n\\n            </div>\\n        </div>\\n        ')\n_______________ TestChapterRoutines.test_unique_layout_per_page ________________\nbackend/tests/unit/test_chapter_routines.py:82: in test_unique_layout_per_page\n    self.assertIn('layout_type', layout)\nE   AssertionError: 'layout_type' not found in ChapterLayout(left=[], center=[UIComponent(type='markdown', label=None, value=None, title=None, content='\\n        <div class=\"mag-layout-container\">\\n            \\n            <div class=\"mag-provenance-header\">\\n                <div class=\"prov-badge conf-high\">\\n                    <ion-icon name=\"shield-checkmark\"></ion-icon>\\n                    AI Vertrouwen: HIGH\\n                </div>\\n                <div class=\"prov-details\">\\n                    <span><ion-icon name=\"hardware-chip\"></ion-icon> v5.0-Deterministic</span>\\n                    <span><ion-icon name=\"time\"></ion-icon> </span>\\n                </div>\\n            </div>\\n            \\n            \\n            <div class=\"mag-intro-section\">\\n                <div class=\"mag-lead-text\">\\n                    Deze sectie bevat de visuele documentatie van de woning (0 foto\\'s).\\n                </div>\\n            </div>\\n\\n            <div class=\"mag-split-grid\">\\n                <div class=\"mag-col-text\">\\n                    \\n            <div class=\"mag-domain-grid\">\\n                <h4 class=\"mag-section-header\">Domein Variabelen Check</h4>\\n                <div class=\"mag-var-container\">\\n                    \\n                <div class=\"mag-var-card status-fact\">\\n                    <div class=\"mag-var-header\">\\n                        <ion-icon name=\"checkmark-circle\"></ion-icon>\\n                        <span class=\"mag-var-label\">aantal_fotos</span>\\n                    </div>\\n                    <div class=\"mag-var-value\">0</div>\\n                    <div class=\"mag-var-reasoning\">Gescand via scraper.</div>\\n                </div>\\n                \\n                <div class=\"mag-var-card status-inferred\">\\n                    <div class=\"mag-var-header\">\\n                        <ion-icon name=\"bulb\"></ion-icon>\\n                        <span class=\"mag-var-label\">visueel_bewijs</span>\\n                    </div>\\n                    <div class=\"mag-var-value\">Beperkt</div>\\n                    <div class=\"mag-var-reasoning\">Dekkingsgraad van het beeldmateriaal.</div>\\n                </div>\\n                \\n                <div class=\"mag-var-card status-fact\">\\n                    <div class=\"mag-var-header\">\\n                        <ion-icon name=\"checkmark-circle\"></ion-icon>\\n                        <span class=\"mag-var-label\">metadata_status</span>\\n                    </div>\\n                    <div class=\"mag-var-value\">Geverifieerd</div>\\n                    <div class=\"mag-var-reasoning\">Metadata ge\u00ebxtraheerd uit browser context.</div>\\n                </div>\\n                \\n                </div>\\n            </div>\\n            \\n                    <div class=\"mag-prose\">\\n                        <p>De mediabibliotheek biedt een compleet overzicht van alle ge\u00ebxtraheerde beelden. Gebruik de dedicated Media Tab in de zijbalk voor een interactieve weergave.</p>\\n                    </div>\\n                    \\n                    \\n                    \\n            <div class=\"mag-conclusion-bar\">\\n                <div class=\"mag-conclusion-icon\"><ion-icon name=\"ribbon\"></ion-icon></div>\\n                <div class=\"mag-conclusion-text\">\\n                    <strong>Conclusie:</strong> Visueel bewijs van 0 bronnen vastgelegd.\\n                </div>\\n            </div>\\n            \\n                </div>\\n\\n                <div class=\"mag-col-visuals\">\\n                    \\n                    \\n                    <div id=\"mag-dynamic-sidebar-target\"></div> \\n                </div>\\n\\n            </div>\\n        </div>\\n        ', trend=None, icon=None, provenance=None)], right=[UIComponent(type='advisor_card', label=None, value=None, title='Visuele Audit', content=\"De AI heeft de foto's geanalyseerd op onderhoud, kwaliteit en risico's.\", trend=None, icon=None, provenance=None)])\n_________ TestChapterRoutines.test_z_generate_design_compliance_report _________\nbackend/tests/unit/test_chapter_routines.py:147: in test_z_generate_design_compliance_report\n    metrics_list = layout.get('metrics', [])\n                   ^^^^^^^^^^\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/pydantic/main.py:1026: in __getattr__\n    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')\nE   AttributeError: 'ChapterLayout' object has no attribute 'get'\n______________ TestDisplayUnits.test_derived_metrics_consistency _______________\nbackend/tests/unit/test_display_units.py:19: in setUp\n    self.chapters = build_chapters(self.core_data)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nbackend/main.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766440157926, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n________________ TestDisplayUnits.test_no_duplicate_m2_in_hero _________________\nbackend/tests/unit/test_display_units.py:19: in setUp\n    self.chapters = build_chapters(self.core_data)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nbackend/main.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766440157946, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n_______________ TestDisplayUnits.test_no_duplicate_m2_in_metrics _______________\nbackend/tests/unit/test_display_units.py:19: in setUp\n    self.chapters = build_chapters(self.core_data)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nbackend/main.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766440157964, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n_____________ TestDisplayUnits.test_price_m2_calculation_accuracy ______________\nbackend/tests/unit/test_display_units.py:19: in setUp\n    self.chapters = build_chapters(self.core_data)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nbackend/main.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766440157980, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=1) __\nbackend/tests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nbackend/chapters/chapter_1.py:68: in generate\n    main_content = self._render_rich_narrative(narrative)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nbackend/chapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=2) __\nbackend/tests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nbackend/chapters/chapter_2.py:75: in generate\n    \"main\": {\"title\": \"Marcel & Petra Matchoverzicht\", \"content\": self._render_rich_narrative(narrative)},\n                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nbackend/chapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=3) __\nbackend/tests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nbackend/chapters/chapter_3.py:60: in generate\n    risk_html = self._render_rich_narrative(narrative, extra_html=f\"\"\"\nbackend/chapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=4) __\nbackend/tests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nbackend/chapters/chapter_4.py:75: in generate\n    imp_html = self._render_rich_narrative(narrative, extra_html=f\"\"\"\nbackend/chapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=5) __\nbackend/tests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nbackend/chapters/chapter_5.py:63: in generate\n    main_content = self._render_rich_narrative(narrative, extra_html=f\"\"\"\nbackend/chapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=6) __\nbackend/tests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nbackend/chapters/chapter_6.py:54: in generate\n    main_content = self._render_rich_narrative(narrative, extra_html=f\"\"\"\nbackend/chapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=7) __\nbackend/tests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nbackend/chapters/chapter_7.py:54: in generate\n    main_content = self._render_rich_narrative(narrative, extra_html=f\"\"\"\nbackend/chapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=8) __\nbackend/tests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nbackend/chapters/chapter_8.py:52: in generate\n    main_content = self._render_rich_narrative(narrative, extra_html=f\"\"\"\nbackend/chapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=9) __\nbackend/tests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nbackend/chapters/chapter_9.py:49: in generate\n    main_content = self._render_rich_narrative(narrative, extra_html=f\"\"\"\nbackend/chapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=10) _\nbackend/tests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nbackend/chapters/chapter_10.py:59: in generate\n    breakdown_html = self._render_rich_narrative(narrative, extra_html=f\"\"\"\nbackend/chapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=11) _\nbackend/tests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nbackend/chapters/chapter_11.py:87: in generate\n    main_content = self._render_rich_narrative(narrative, extra_html=f\"\"\"\nbackend/chapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=12) _\nbackend/tests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nbackend/chapters/chapter_12.py:22: in generate\n    main_content = self._render_rich_narrative(narrative)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nbackend/chapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n___________________ TestDynamicChapters.test_chapter_titles ____________________\nbackend/tests/unit/test_dynamic_chapters.py:102: in test_chapter_titles\n    self.assertIn(\"Algemene Woningkenmerken\", c1.generate().title)\n                                              ^^^^^^^^^^^^^\nbackend/chapters/chapter_1.py:68: in generate\n    main_content = self._render_rich_narrative(narrative)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nbackend/chapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 1: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\n__________ TestDynamicChapters.test_dynamic_intelligence_integration ___________\nbackend/tests/unit/test_dynamic_chapters.py:84: in test_dynamic_intelligence_integration\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nbackend/chapters/chapter_1.py:68: in generate\n    main_content = self._render_rich_narrative(narrative)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nbackend/chapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 1: Ollama failed: Event loop is closed\n______________ TestExploreInsights.test_capture_chapter_insights _______________\nbackend/tests/unit/test_explore_insights.py:43: in test_capture_chapter_insights\n    chapters = build_chapters(core_data)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^\nbackend/main.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766440158120, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n----------------------------- Captured stdout call -----------------------------\n\n[INFO] Generating chapters for mock property: Inzichtslaan 42, Toekomststad...\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n__________________ TestRegression.test_chapter_data_bridging ___________________\nbackend/tests/unit/test_frontend_compatibility.py:27: in test_chapter_data_bridging\n    chapters = build_chapters(core_data)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^\nbackend/main.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766440158135, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n____________________ TestRegression.test_chapter_id_present ____________________\nbackend/tests/unit/test_frontend_compatibility.py:16: in test_chapter_id_present\n    chapters = build_chapters(core_data)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^\nbackend/main.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766440158153, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n____________ TestImageUploadIntegration.test_paste_with_media_urls _____________\nbackend/tests/unit/test_image_upload.py:189: in test_paste_with_media_urls\n    assert create_response.status_code == 200\nE   assert 405 == 200\nE    +  where 405 = <Response [405 Method Not Allowed]>.status_code\n___________ TestIntelligenceEngine.test_chapter_0_executive_summary ____________\nbackend/tests/unit/test_intelligence.py:56: in test_chapter_0_executive_summary\n    self.assertIn(\"500,000\", nar['intro'])\nE   AssertionError: '500,000' not found in 'Welkom bij de strategische analyse van de Test. Dit rapport combineert harde data met AI-gestuurde interpretaties om een compleet beeld van uw potenti\u00eble aankoop te vormen.'\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\n_______________ TestModernChapter.test_chapter_structure_modern ________________\nbackend/tests/unit/test_modern_chapter.py:14: in test_chapter_structure_modern\n    chapters = build_chapters(core_data)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^\nbackend/main.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766440158416, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n_________________ TestModernChapter.test_energy_chapter_layout _________________\nbackend/tests/unit/test_modern_chapter.py:59: in test_energy_chapter_layout\n    chapters = build_chapters(core_data)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^\nbackend/main.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766440158435, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n______________ TestModernDesignCompliance.test_all_chapters_exist ______________\nbackend/tests/unit/test_modern_design_compliance.py:21: in setUp\n    self.chapters = build_chapters(self.core_data)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nbackend/main.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766440158451, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n________ TestModernDesignCompliance.test_data_integrity_no_placeholders ________\nbackend/tests/unit/test_modern_design_compliance.py:21: in setUp\n    self.chapters = build_chapters(self.core_data)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nbackend/main.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766440158468, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n_____________ TestModernDesignCompliance.test_enriched_by_ai_check _____________\nbackend/tests/unit/test_modern_design_compliance.py:21: in setUp\n    self.chapters = build_chapters(self.core_data)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nbackend/main.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766440158488, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n________ TestModernDesignCompliance.test_modern_4k_structure_compliance ________\nbackend/tests/unit/test_modern_design_compliance.py:21: in setUp\n    self.chapters = build_chapters(self.core_data)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nbackend/main.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766440158504, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:329 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n__________ TestOllamaIntegration.test_ai_narrative_generation_success __________\nbackend/tests/unit/test_ollama_integration.py:65: in test_ai_narrative_generation_success\n    self.assertIn(\"Deze analyse is gegenereerd door de Funda AI-engine\", result['interpretation'])\nE   AssertionError: 'Deze analyse is gegenereerd door de Funda AI-engine' not found in 'AI Interpretation\\n\\nDeze analyse is gegenereerd door de AI-engine (Deep Analysis Mode).'\n________ TestPreferencesCompliance.test_marcel_petra_preferences_match _________\nbackend/tests/unit/test_preferences_compliance.py:56: in test_marcel_petra_preferences_match\n    self.assertRegex(narrative['intro'], r\"match van 42%\", \"Percentage should be reported in intro as 42% for this scenario\")\nE   AssertionError: Regex didn't match: 'match van 42%' not found in 'Op basis van de aangescherpte profielen van Marcel (Tech & Infra) en Petra (Sfeer & Comfort) scoort deze woning een match van 43%.' : Percentage should be reported in intro as 42% for this scenario\n_____________ TestOpenAIProvider.test_openai_check_health_success ______________\nbackend/tests/unit/test_providers.py:339: in test_openai_check_health_success\n    provider.client.models.list = AsyncMock(return_value=Mock())\n    ^^^^^^^^^^^^^^^^^^^^^^\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/functools.py:1001: in __get__\n    val = self.func(instance)\n          ^^^^^^^^^^^^^^^^^^^\n../../Library/Python/3.11/lib/python/site-packages/openai/_client.py:530: in models\n    from .resources.models import AsyncModels\nE   ModuleNotFoundError: No module named 'openai.resources.models'; 'openai.resources' is not a package\n_____________ TestOpenAIProvider.test_openai_check_health_failure ______________\nbackend/tests/unit/test_providers.py:350: in test_openai_check_health_failure\n    provider.client.models.list = AsyncMock(\n    ^^^^^^^^^^^^^^^^^^^^^^\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/functools.py:1001: in __get__\n    val = self.func(instance)\n          ^^^^^^^^^^^^^^^^^^^\n../../Library/Python/3.11/lib/python/site-packages/openai/_client.py:530: in models\n    from .resources.models import AsyncModels\nE   ModuleNotFoundError: No module named 'openai.resources.models'; 'openai.resources' is not a package\n_____________ TestGeminiProvider.test_gemini_check_health_success ______________\nbackend/tests/unit/test_providers.py:579: in test_gemini_check_health_success\n    provider.client.aio.models.list.side_effect = mock_async_iterator\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   AttributeError: 'method' object has no attribute 'side_effect'\n_____________ TestGeminiProvider.test_gemini_check_health_failure ______________\nbackend/tests/unit/test_providers.py:599: in test_gemini_check_health_failure\n    provider.client.aio.models.list.side_effect = Exception(\"Error\")\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   AttributeError: 'method' object has no attribute 'side_effect'\n=========================== short test summary info ============================\nFAILED backend/tests/e2e/test_pdf_export.py::TestPDFExport::test_pdf_export_functionality\nFAILED backend/tests/integration/test_comprehensive.py::TestComprehensive::test_all_chapters_generated\nFAILED backend/tests/integration/test_integration.py::TestIntegration::test_full_flow_with_paste\nFAILED backend/tests/test_verify_consistency.py::test_consistency_check_happy_path\nFAILED backend/tests/unit/test_api_endpoints.py::TestApiEndpoints::test_create_run_defaults\nFAILED backend/tests/unit/test_api_endpoints.py::TestApiEndpoints::test_get_nonexistent_run\nFAILED backend/tests/unit/test_api_endpoints.py::TestApiEndpoints::test_health_check\nFAILED backend/tests/unit/test_api_endpoints.py::TestApiEndpoints::test_start_run_updates_status\nFAILED backend/tests/unit/test_async_pipeline.py::TestAsyncPipeline::test_start_run_returns_immediately\nFAILED backend/tests/unit/test_async_pipeline.py::TestAsyncPipeline::test_status_polling_endpoint_exists\nFAILED backend/tests/unit/test_async_pipeline.py::TestAsyncPipeline::test_status_polling_progress_calculation\nFAILED backend/tests/unit/test_async_pipeline.py::TestAsyncPipeline::test_status_endpoint_404_for_nonexistent_run\nFAILED backend/tests/unit/test_async_pipeline.py::TestAsyncPipeline::test_pipeline_runs_in_background\nFAILED backend/tests/unit/test_async_pipeline.py::TestAsyncPipeline::test_multiple_concurrent_pipelines\nFAILED backend/tests/unit/test_async_pipeline.py::TestThreadExecutor::test_executor_exists\nFAILED backend/tests/unit/test_async_pipeline.py::TestBackwardCompatibility::test_report_endpoint_still_works\nFAILED backend/tests/unit/test_async_pipeline.py::TestBackwardCompatibility::test_create_run_endpoint_unchanged\nFAILED backend/tests/unit/test_chapter_0_logic.py::TestChapter0Logic::test_address_cleanup\nFAILED backend/tests/unit/test_chapter_0_logic.py::TestChapter0Logic::test_robotic_currency\nFAILED backend/tests/unit/test_chapter_routines.py::TestChapterRoutines::test_unique_layout_per_page\nFAILED backend/tests/unit/test_chapter_routines.py::TestChapterRoutines::test_z_generate_design_compliance_report\nFAILED backend/tests/unit/test_display_units.py::TestDisplayUnits::test_derived_metrics_consistency\nFAILED backend/tests/unit/test_display_units.py::TestDisplayUnits::test_no_duplicate_m2_in_hero\nFAILED backend/tests/unit/test_display_units.py::TestDisplayUnits::test_no_duplicate_m2_in_metrics\nFAILED backend/tests/unit/test_display_units.py::TestDisplayUnits::test_price_m2_calculation_accuracy\nSUBFAILED(chapter=1) backend/tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=2) backend/tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=3) backend/tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=4) backend/tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=5) backend/tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=6) backend/tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=7) backend/tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=8) backend/tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=9) backend/tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=10) backend/tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=11) backend/tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=12) backend/tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nFAILED backend/tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_chapter_titles\nFAILED backend/tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_dynamic_intelligence_integration\nFAILED backend/tests/unit/test_explore_insights.py::TestExploreInsights::test_capture_chapter_insights\nFAILED backend/tests/unit/test_frontend_compatibility.py::TestRegression::test_chapter_data_bridging\nFAILED backend/tests/unit/test_frontend_compatibility.py::TestRegression::test_chapter_id_present\nFAILED backend/tests/unit/test_image_upload.py::TestImageUploadIntegration::test_paste_with_media_urls\nFAILED backend/tests/unit/test_intelligence.py::TestIntelligenceEngine::test_chapter_0_executive_summary\nFAILED backend/tests/unit/test_modern_chapter.py::TestModernChapter::test_chapter_structure_modern\nFAILED backend/tests/unit/test_modern_chapter.py::TestModernChapter::test_energy_chapter_layout\nFAILED backend/tests/unit/test_modern_design_compliance.py::TestModernDesignCompliance::test_all_chapters_exist\nFAILED backend/tests/unit/test_modern_design_compliance.py::TestModernDesignCompliance::test_data_integrity_no_placeholders\nFAILED backend/tests/unit/test_modern_design_compliance.py::TestModernDesignCompliance::test_enriched_by_ai_check\nFAILED backend/tests/unit/test_modern_design_compliance.py::TestModernDesignCompliance::test_modern_4k_structure_compliance\nFAILED backend/tests/unit/test_ollama_integration.py::TestOllamaIntegration::test_ai_narrative_generation_success\nFAILED backend/tests/unit/test_preferences_compliance.py::TestPreferencesCompliance::test_marcel_petra_preferences_match\nFAILED backend/tests/unit/test_providers.py::TestOpenAIProvider::test_openai_check_health_success\nFAILED backend/tests/unit/test_providers.py::TestOpenAIProvider::test_openai_check_health_failure\nFAILED backend/tests/unit/test_providers.py::TestGeminiProvider::test_gemini_check_health_success\nFAILED backend/tests/unit/test_providers.py::TestGeminiProvider::test_gemini_check_health_failure\n======= 56 failed, 161 passed, 205 warnings, 28 subtests passed in 6.72s =======",
      "start_time": "2025-12-22T21:49:12.010974Z",
      "end_time": "2025-12-22T21:49:19.535459Z",
      "status": "failed",
      "reason": null,
      "parsed_results": null
    },
    {
      "framework": "jest",
      "command": "npx jest --runInBand",
      "exit_code": -1,
      "raw_output": "Test execution timed out after 5 minutes",
      "start_time": "2025-12-22T21:49:12.011103Z",
      "end_time": "2025-12-22T21:54:12.149112Z",
      "status": "error",
      "reason": "Timeout after 300 seconds",
      "parsed_results": null
    },
    {
      "framework": "go test",
      "command": "go test ./... -v",
      "exit_code": -1,
      "raw_output": "Skipped: no Go source files detected.",
      "start_time": "2025-12-22T21:49:12.010478Z",
      "end_time": "2025-12-22T21:49:12.010478Z",
      "status": "skipped",
      "reason": "No Go source files detected in repository.",
      "parsed_results": null
    },
    {
      "framework": "cargo test",
      "command": "cargo test --verbose",
      "exit_code": -1,
      "raw_output": "Skipped: no Rust source files detected.",
      "start_time": "2025-12-22T21:49:12.010478Z",
      "end_time": "2025-12-22T21:49:12.010478Z",
      "status": "skipped",
      "reason": "No Rust source files detected in repository.",
      "parsed_results": null
    },
    {
      "framework": "maven/gradle",
      "command": "mvn test || gradle test",
      "exit_code": -1,
      "raw_output": "Skipped: no Java source files detected.",
      "start_time": "2025-12-22T21:49:12.010478Z",
      "end_time": "2025-12-22T21:49:12.010478Z",
      "status": "skipped",
      "reason": "No Java source files detected in repository.",
      "parsed_results": null
    },
    {
      "framework": "rspec/minitest",
      "command": "rspec || rake test",
      "exit_code": -1,
      "raw_output": "Skipped: no Ruby source files detected.",
      "start_time": "2025-12-22T21:49:12.010478Z",
      "end_time": "2025-12-22T21:49:12.010478Z",
      "status": "skipped",
      "reason": "No Ruby source files detected in repository.",
      "parsed_results": null
    }
  ]
}