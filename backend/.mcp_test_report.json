{
  "executed_at": "2025-12-22T21:27:47.684986Z",
  "root": "/Users/marcelkurvers/Development/funda-app/backend",
  "summary": {
    "total_runs": 6,
    "success": 0,
    "failed": 1,
    "skipped": 5
  },
  "runs": [
    {
      "framework": "pytest",
      "command": "pytest",
      "exit_code": 1,
      "raw_output": "============================= test session starts ==============================\nplatform darwin -- Python 3.11.4, pytest-9.0.2, pluggy-1.6.0 -- /Library/Frameworks/Python.framework/Versions/3.11/bin/python3.11\ncachedir: .pytest_cache\nrootdir: /Users/marcelkurvers/Development/funda-app\nconfigfile: pytest.ini\nplugins: anyio-4.10.0, asyncio-1.3.0\nasyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function\ncollecting ... collected 206 items\n\ntest_extraction.py::test_photo_extraction PASSED                         [  0%]\ntests/e2e/test_frontend.py::TestFrontendStructure::test_01_index_html_structure PASSED [  0%]\ntests/e2e/test_frontend.py::TestFrontendStructure::test_02_preferences_html_structure PASSED [  1%]\ntests/e2e/test_pdf_export.py::TestPDFExport::test_pdf_export_functionality FAILED [  1%]\ntests/integration/test_comprehensive.py::TestComprehensive::test_all_chapters_generated FAILED [  2%]\ntests/integration/test_comprehensive.py::TestComprehensive::test_energy_label_logic PASSED [  2%]\ntests/integration/test_comprehensive.py::TestComprehensive::test_kpi_calculations_robustness PASSED [  3%]\ntests/integration/test_consistency.py::TestChapterConsistency::test_bedroom_logic PASSED [  3%]\ntests/integration/test_consistency.py::TestChapterConsistency::test_content_text_consistency PASSED [  4%]\ntests/integration/test_consistency.py::TestChapterConsistency::test_energy_label_consistency PASSED [  4%]\ntests/integration/test_consistency.py::TestChapterConsistency::test_living_area_consistency PASSED [  5%]\ntests/integration/test_consistency.py::TestChapterConsistency::test_price_consistency PASSED [  5%]\ntests/integration/test_consistency.py::TestChapterConsistency::test_sqm_price_consistency PASSED [  6%]\ntests/integration/test_docker_sync.py::TestDockerSync::test_ensure_latest_docker_build PASSED [  6%]\ntests/integration/test_integration.py::TestIntegration::test_full_flow_with_paste FAILED [  7%]\ntests/integration/test_integration_fixtures.py::TestFixturesOutput::test_fixtures_generation \ntests/integration/test_integration_fixtures.py::TestFixturesOutput::test_fixtures_generation PASSED [  7%]\ntests/quality/test_audit_codebase.py::test_audit_codebase_for_mocks_and_hardcoded_items PASSED [  8%]\ntests/quality/test_dynamism.py::TestDynamism::test_dynamism_score_generation PASSED [  8%]\ntests/test_verify_consistency.py::test_consistency_check_happy_path FAILED [  9%]\ntests/test_verify_consistency.py::test_consistency_check_detects_price_mismatch PASSED [  9%]\ntests/test_verify_consistency.py::test_consistency_check_detects_label_mismatch PASSED [ 10%]\ntests/unit/test_ai_interpretation.py::TestAiInterpretation::test_all_chapters_generation \ntests/unit/test_ai_interpretation.py::TestAiInterpretation::test_all_chapters_generation PASSED [ 10%]\ntests/unit/test_ai_interpretation.py::TestAiInterpretation::test_html_structure_consistency PASSED [ 11%]\ntests/unit/test_ai_interpretation.py::TestAiInterpretation::test_scenario_luxury_villa PASSED [ 11%]\ntests/unit/test_ai_interpretation.py::TestAiInterpretation::test_scenario_modern_eco_house PASSED [ 12%]\ntests/unit/test_ai_interpretation.py::TestAiInterpretation::test_scenario_old_fixer_upper PASSED [ 12%]\ntests/unit/test_ai_refactor.py::test_provider_factory_listing PASSED     [ 13%]\ntests/unit/test_ai_refactor.py::test_provider_factory_creation_with_model PASSED [ 13%]\ntests/unit/test_ai_refactor.py::test_api_ai_models_endpoint PASSED       [ 14%]\ntests/unit/test_ai_refactor.py::test_preferences_sync_with_ai_settings FAILED [ 14%]\ntests/unit/test_api_endpoints.py::TestApiEndpoints::test_create_run_defaults FAILED [ 15%]\ntests/unit/test_api_endpoints.py::TestApiEndpoints::test_get_nonexistent_run FAILED [ 15%]\ntests/unit/test_api_endpoints.py::TestApiEndpoints::test_health_check FAILED [ 16%]\ntests/unit/test_api_endpoints.py::TestApiEndpoints::test_preferences_api PASSED [ 16%]\ntests/unit/test_api_endpoints.py::TestApiEndpoints::test_start_run_updates_status FAILED [ 16%]\ntests/unit/test_async_pipeline.py::TestAsyncPipeline::test_start_run_returns_immediately FAILED [ 17%]\ntests/unit/test_async_pipeline.py::TestAsyncPipeline::test_status_polling_endpoint_exists FAILED [ 17%]\ntests/unit/test_async_pipeline.py::TestAsyncPipeline::test_status_polling_progress_calculation FAILED [ 18%]\ntests/unit/test_async_pipeline.py::TestAsyncPipeline::test_status_endpoint_404_for_nonexistent_run FAILED [ 18%]\ntests/unit/test_async_pipeline.py::TestAsyncPipeline::test_pipeline_runs_in_background FAILED [ 19%]\ntests/unit/test_async_pipeline.py::TestAsyncPipeline::test_multiple_concurrent_pipelines FAILED [ 19%]\ntests/unit/test_async_pipeline.py::TestThreadExecutor::test_executor_exists FAILED [ 20%]\ntests/unit/test_async_pipeline.py::TestThreadExecutor::test_simulate_pipeline_callable PASSED [ 20%]\ntests/unit/test_async_pipeline.py::TestBackwardCompatibility::test_report_endpoint_still_works FAILED [ 21%]\ntests/unit/test_async_pipeline.py::TestBackwardCompatibility::test_create_run_endpoint_unchanged FAILED [ 21%]\ntests/unit/test_chapter_0_logic.py::TestChapter0Logic::test_address_cleanup FAILED [ 22%]\ntests/unit/test_chapter_0_logic.py::TestChapter0Logic::test_robotic_currency FAILED [ 22%]\ntests/unit/test_chapter_0_logic.py::TestChapter0Logic::test_maintenance_consistency FAILED [ 23%]\ntests/unit/test_chapter_routines.py::TestChapterRoutines::test_chapter_file_correspondence \ntests/unit/test_chapter_routines.py::TestChapterRoutines::test_chapter_file_correspondence PASSED [ 23%]\ntests/unit/test_chapter_routines.py::TestChapterRoutines::test_unique_layout_per_page FAILED [ 24%]\ntests/unit/test_chapter_routines.py::TestChapterRoutines::test_z_generate_design_compliance_report FAILED [ 24%]\ntests/unit/test_chapters.py::TestChapters::test_chapter_generation FAILED [ 25%]\ntests/unit/test_chapters.py::TestChapters::test_chapter_registry PASSED  [ 25%]\ntests/unit/test_complex_parsing.py::TestComplexParsing::test_no_classes_layout PASSED [ 26%]\ntests/unit/test_config_api.py::test_get_full_config PASSED               [ 26%]\ntests/unit/test_config_api.py::test_get_config_section PASSED            [ 27%]\ntests/unit/test_config_api.py::test_get_config_section_not_found PASSED  [ 27%]\ntests/unit/test_config_api.py::test_get_config_value PASSED              [ 28%]\ntests/unit/test_config_api.py::test_update_config_bulk PASSED            [ 28%]\ntests/unit/test_config_api.py::test_update_config_value PASSED           [ 29%]\ntests/unit/test_config_api.py::test_update_config_invalid_section PASSED [ 29%]\ntests/unit/test_config_api.py::test_update_config_invalid_key PASSED     [ 30%]\ntests/unit/test_display_units.py::TestDisplayUnits::test_derived_metrics_consistency FAILED [ 30%]\ntests/unit/test_display_units.py::TestDisplayUnits::test_no_duplicate_m2_in_hero FAILED [ 31%]\ntests/unit/test_display_units.py::TestDisplayUnits::test_no_duplicate_m2_in_metrics FAILED [ 31%]\ntests/unit/test_display_units.py::TestDisplayUnits::test_price_m2_calculation_accuracy FAILED [ 32%]\ntests/unit/test_domain_models.py::TestDomainModels::test_chapter_output_flexibility PASSED [ 32%]\ntests/unit/test_domain_models.py::TestDomainModels::test_property_core_defaults PASSED [ 33%]\ntests/unit/test_domain_models.py::TestDomainModels::test_ui_component_structure PASSED [ 33%]\ntests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard \ntests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard PASSED [ 33%]\ntests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_chapter_titles FAILED [ 34%]\ntests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_dynamic_intelligence_integration FAILED [ 34%]\ntests/unit/test_explore_insights.py::TestExploreInsights::test_capture_chapter_insights FAILED [ 35%]\ntests/unit/test_frontend_compatibility.py::TestRegression::test_chapter_data_bridging FAILED [ 35%]\ntests/unit/test_frontend_compatibility.py::TestRegression::test_chapter_id_present FAILED [ 36%]\ntests/unit/test_image_upload.py::TestImageUpload::test_upload_endpoint_exists PASSED [ 36%]\ntests/unit/test_image_upload.py::TestImageUpload::test_upload_valid_image PASSED [ 37%]\ntests/unit/test_image_upload.py::TestImageUpload::test_upload_jpg_image PASSED [ 37%]\ntests/unit/test_image_upload.py::TestImageUpload::test_upload_non_image_file_rejected PASSED [ 38%]\ntests/unit/test_image_upload.py::TestImageUpload::test_upload_oversized_image_rejected PASSED [ 38%]\ntests/unit/test_image_upload.py::TestImageUpload::test_uploaded_file_is_accessible PASSED [ 39%]\ntests/unit/test_image_upload.py::TestImageUpload::test_upload_generates_unique_filenames PASSED [ 39%]\ntests/unit/test_image_upload.py::TestImageUpload::test_upload_preserves_file_extension PASSED [ 40%]\ntests/unit/test_image_upload.py::TestImageUpload::test_upload_directory_exists PASSED [ 40%]\ntests/unit/test_image_upload.py::TestImageUpload::test_upload_handles_special_characters_in_filename PASSED [ 41%]\ntests/unit/test_image_upload.py::TestImageUploadIntegration::test_paste_with_media_urls FAILED [ 41%]\ntests/unit/test_image_upload.py::TestImageUploadSecurity::test_upload_without_authentication PASSED [ 42%]\ntests/unit/test_image_upload.py::TestImageUploadSecurity::test_path_traversal_prevention PASSED [ 42%]\ntests/unit/test_intelligence.py::TestIntelligenceEngine::test_chapter_0_executive_summary FAILED [ 43%]\ntests/unit/test_intelligence.py::TestIntelligenceEngine::test_chapter_4_energy_logic PASSED [ 43%]\ntests/unit/test_intelligence.py::TestIntelligenceEngine::test_generate_chapter_narrative_structure PASSED [ 44%]\ntests/unit/test_intelligence.py::TestIntelligenceEngine::test_parse_int_helper PASSED [ 44%]\ntests/unit/test_modern_chapter.py::TestModernChapter::test_chapter_structure_modern FAILED [ 45%]\ntests/unit/test_modern_chapter.py::TestModernChapter::test_energy_chapter_layout FAILED [ 45%]\ntests/unit/test_modern_design_compliance.py::TestModernDesignCompliance::test_all_chapters_exist FAILED [ 46%]\ntests/unit/test_modern_design_compliance.py::TestModernDesignCompliance::test_data_integrity_no_placeholders FAILED [ 46%]\ntests/unit/test_modern_design_compliance.py::TestModernDesignCompliance::test_enriched_by_ai_check FAILED [ 47%]\ntests/unit/test_modern_design_compliance.py::TestModernDesignCompliance::test_modern_4k_structure_compliance FAILED [ 47%]\ntests/unit/test_ollama_integration.py::TestOllamaIntegration::test_ai_narrative_generation_failure_fallback PASSED [ 48%]\ntests/unit/test_ollama_integration.py::TestOllamaIntegration::test_ai_narrative_generation_success FAILED [ 48%]\ntests/unit/test_ollama_integration.py::TestOllamaIntegration::test_prompt_structure_contains_preferences PASSED [ 49%]\ntests/unit/test_ollama_integration.py::TestOllamaIntegration::test_provider_injection PASSED [ 49%]\ntests/unit/test_parser.py::TestParser::test_bedroom_extraction_from_rooms PASSED [ 50%]\ntests/unit/test_parser.py::TestParser::test_comprehensive_field_extraction PASSED [ 50%]\ntests/unit/test_parser.py::TestParser::test_cross_validation_bedrooms_vs_rooms PASSED [ 50%]\ntests/unit/test_parser.py::TestParser::test_data_quality_report PASSED   [ 51%]\ntests/unit/test_parser.py::TestParser::test_illogical_data_validation PASSED [ 51%]\ntests/unit/test_parser.py::TestParser::test_parse_real_fixture PASSED    [ 52%]\ntests/unit/test_parser.py::TestParser::test_parse_sample PASSED          [ 52%]\ntests/unit/test_parser_edge_cases.py::TestParserEdgeCases::test_navigation_text_address_bug PASSED [ 53%]\ntests/unit/test_parser_edge_cases.py::TestParserEdgeCases::test_photo_count_as_rooms_bug PASSED [ 53%]\ntests/unit/test_parser_edge_cases.py::TestParserEdgeCases::test_suspicious_room_count_correction PASSED [ 54%]\ntests/unit/test_parser_edge_cases.py::TestParserEdgeCases::test_duplicate_m2_display_fix PASSED [ 54%]\ntests/unit/test_parser_edge_cases_additional.py::test_address_blocklist_ignored PASSED [ 55%]\ntests/unit/test_parser_edge_cases_additional.py::test_bedroom_capping PASSED [ 55%]\ntests/unit/test_preferences_compliance.py::TestPreferencesCompliance::test_marcel_petra_preferences_match PASSED [ 56%]\ntests/unit/test_preferences_compliance.py::TestPreferencesCompliance::test_missing_preferences_handling PASSED [ 56%]\ntests/unit/test_preferenties_vergelijking.py::TestPreferentiesVergelijking::test_vergelijking_logica PASSED [ 57%]\ntests/unit/test_provider_factory.py::TestProviderRegistry::test_list_providers_returns_all_registered PASSED [ 57%]\ntests/unit/test_provider_factory.py::TestProviderRegistry::test_registry_contains_correct_classes PASSED [ 58%]\ntests/unit/test_provider_factory.py::TestProviderRegistry::test_register_new_provider PASSED [ 58%]\ntests/unit/test_provider_factory.py::TestProviderFactory::test_create_ollama_provider_default PASSED [ 59%]\ntests/unit/test_provider_factory.py::TestProviderFactory::test_create_ollama_provider_custom_url PASSED [ 59%]\ntests/unit/test_provider_factory.py::TestProviderFactory::test_create_ollama_provider_custom_timeout PASSED [ 60%]\ntests/unit/test_provider_factory.py::TestProviderFactory::test_create_openai_provider_with_api_key PASSED [ 60%]\ntests/unit/test_provider_factory.py::TestProviderFactory::test_create_openai_provider_without_api_key_raises_error PASSED [ 61%]\ntests/unit/test_provider_factory.py::TestProviderFactory::test_create_anthropic_provider_with_api_key PASSED [ 61%]\ntests/unit/test_provider_factory.py::TestProviderFactory::test_create_anthropic_provider_without_api_key_raises_error PASSED [ 62%]\ntests/unit/test_provider_factory.py::TestProviderFactory::test_create_gemini_provider_with_api_key PASSED [ 62%]\ntests/unit/test_provider_factory.py::TestProviderFactory::test_create_gemini_provider_without_api_key_raises_error PASSED [ 63%]\ntests/unit/test_provider_factory.py::TestProviderFactory::test_create_unknown_provider_raises_error PASSED [ 63%]\ntests/unit/test_provider_factory.py::TestProviderFactory::test_create_provider_with_extra_kwargs PASSED [ 64%]\ntests/unit/test_provider_factory.py::TestProviderFactory::test_create_all_providers_with_valid_config PASSED [ 64%]\ntests/unit/test_provider_factory.py::TestProviderFactory::test_provider_factory_respects_timeout_parameter PASSED [ 65%]\ntests/unit/test_provider_factory.py::TestFactoryRegistryIntegration::test_factory_uses_registry_for_provider_lookup PASSED [ 65%]\ntests/unit/test_provider_factory.py::TestFactoryRegistryIntegration::test_custom_provider_can_be_registered_and_created FAILED [ 66%]\ntests/unit/test_provider_factory.py::TestFactoryRegistryIntegration::test_all_registered_providers_can_be_created PASSED [ 66%]\ntests/unit/test_provider_factory.py::TestProviderFactoryErrorHandling::test_none_provider_name_raises_error PASSED [ 66%]\ntests/unit/test_provider_factory.py::TestProviderFactoryErrorHandling::test_empty_provider_name_raises_error PASSED [ 67%]\ntests/unit/test_provider_factory.py::TestProviderFactoryErrorHandling::test_case_sensitive_provider_names FAILED [ 67%]\ntests/unit/test_provider_factory.py::TestProviderFactoryErrorHandling::test_helpful_error_message_lists_available_providers PASSED [ 68%]\ntests/unit/test_providers.py::TestOllamaProvider::test_ollama_initialization_default PASSED [ 68%]\ntests/unit/test_providers.py::TestOllamaProvider::test_ollama_initialization_custom_url PASSED [ 69%]\ntests/unit/test_providers.py::TestOllamaProvider::test_ollama_initialization_env_var PASSED [ 69%]\ntests/unit/test_providers.py::TestOllamaProvider::test_ollama_initialization_docker_env PASSED [ 70%]\ntests/unit/test_providers.py::TestOllamaProvider::test_ollama_name_property PASSED [ 70%]\ntests/unit/test_providers.py::TestOllamaProvider::test_ollama_list_models_success PASSED [ 71%]\ntests/unit/test_providers.py::TestOllamaProvider::test_ollama_list_models_http_error FAILED [ 71%]\ntests/unit/test_providers.py::TestOllamaProvider::test_ollama_list_models_connection_error FAILED [ 72%]\ntests/unit/test_providers.py::TestOllamaProvider::test_ollama_generate_success PASSED [ 72%]\ntests/unit/test_providers.py::TestOllamaProvider::test_ollama_generate_timeout FAILED [ 73%]\ntests/unit/test_providers.py::TestOllamaProvider::test_ollama_check_health_success PASSED [ 73%]\ntests/unit/test_providers.py::TestOllamaProvider::test_ollama_check_health_failure PASSED [ 74%]\ntests/unit/test_providers.py::TestOpenAIProvider::test_openai_initialization_with_key PASSED [ 74%]\ntests/unit/test_providers.py::TestOpenAIProvider::test_openai_initialization_from_env PASSED [ 75%]\ntests/unit/test_providers.py::TestOpenAIProvider::test_openai_initialization_no_key_raises_error PASSED [ 75%]\ntests/unit/test_providers.py::TestOpenAIProvider::test_openai_name_property PASSED [ 76%]\ntests/unit/test_providers.py::TestOpenAIProvider::test_openai_list_models PASSED [ 76%]\ntests/unit/test_providers.py::TestOpenAIProvider::test_openai_generate_success FAILED [ 77%]\ntests/unit/test_providers.py::TestOpenAIProvider::test_openai_generate_with_json_mode FAILED [ 77%]\ntests/unit/test_providers.py::TestOpenAIProvider::test_openai_generate_error_handling FAILED [ 78%]\ntests/unit/test_providers.py::TestOpenAIProvider::test_openai_check_health_success FAILED [ 78%]\ntests/unit/test_providers.py::TestOpenAIProvider::test_openai_check_health_failure FAILED [ 79%]\ntests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_initialization_with_key PASSED [ 79%]\ntests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_initialization_custom_timeout PASSED [ 80%]\ntests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_name_property PASSED [ 80%]\ntests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_list_models PASSED [ 81%]\ntests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_generate_success PASSED [ 81%]\ntests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_generate_with_json_mode PASSED [ 82%]\ntests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_generate_timeout_error PASSED [ 82%]\ntests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_check_health_success PASSED [ 83%]\ntests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_check_health_failure FAILED [ 83%]\ntests/unit/test_providers.py::TestGeminiProvider::test_gemini_initialization_with_key PASSED [ 83%]\ntests/unit/test_providers.py::TestGeminiProvider::test_gemini_initialization_from_google_env PASSED [ 84%]\ntests/unit/test_providers.py::TestGeminiProvider::test_gemini_initialization_from_gemini_env PASSED [ 84%]\ntests/unit/test_providers.py::TestGeminiProvider::test_gemini_initialization_no_key_raises_error PASSED [ 85%]\ntests/unit/test_providers.py::TestGeminiProvider::test_gemini_name_property PASSED [ 85%]\ntests/unit/test_providers.py::TestGeminiProvider::test_gemini_list_models PASSED [ 86%]\ntests/unit/test_providers.py::TestGeminiProvider::test_gemini_generate_success PASSED [ 86%]\ntests/unit/test_providers.py::TestGeminiProvider::test_gemini_generate_with_json_mode PASSED [ 87%]\ntests/unit/test_providers.py::TestGeminiProvider::test_gemini_generate_error_handling PASSED [ 87%]\ntests/unit/test_providers.py::TestGeminiProvider::test_gemini_check_health_success FAILED [ 88%]\ntests/unit/test_providers.py::TestGeminiProvider::test_gemini_check_health_no_api_key PASSED [ 88%]\ntests/unit/test_providers.py::TestGeminiProvider::test_gemini_check_health_failure FAILED [ 89%]\ntests/unit/test_providers.py::TestProviderInterface::test_all_providers_implement_interface PASSED [ 89%]\ntests/unit/test_providers.py::TestProviderInterface::test_all_providers_have_name_property PASSED [ 90%]\ntests/unit/test_utils.py::TestParsingUtilities::test_parse_float_invalid PASSED [ 90%]\ntests/unit/test_utils.py::TestParsingUtilities::test_parse_float_valid PASSED [ 91%]\ntests/unit/test_utils.py::TestParsingUtilities::test_parse_int_custom_default PASSED [ 91%]\ntests/unit/test_utils.py::TestParsingUtilities::test_parse_int_formatted_numbers PASSED [ 92%]\ntests/unit/test_utils.py::TestParsingUtilities::test_parse_int_invalid_inputs PASSED [ 92%]\ntests/unit/test_utils.py::TestParsingUtilities::test_parse_int_valid_numbers PASSED [ 93%]\ntests/unit/test_utils.py::TestValidationUtilities::test_validate_bedrooms_explicit_count PASSED [ 93%]\ntests/unit/test_utils.py::TestValidationUtilities::test_validate_bedrooms_minimum PASSED [ 94%]\ntests/unit/test_utils.py::TestValidationUtilities::test_validate_bedrooms_normal_range PASSED [ 94%]\ntests/unit/test_utils.py::TestValidationUtilities::test_validate_bedrooms_upper_bound PASSED [ 95%]\ntests/unit/test_utils.py::TestValidationUtilities::test_validate_living_area_bounds PASSED [ 95%]\ntests/unit/test_utils.py::TestValidationUtilities::test_validate_living_area_normal PASSED [ 96%]\ntests/unit/test_utils.py::TestSafetyUtilities::test_ensure_grid_layout_existing PASSED [ 96%]\ntests/unit/test_utils.py::TestSafetyUtilities::test_ensure_grid_layout_missing PASSED [ 97%]\ntests/unit/test_utils.py::TestSafetyUtilities::test_safe_get_existing_key PASSED [ 97%]\ntests/unit/test_utils.py::TestSafetyUtilities::test_safe_get_missing_key PASSED [ 98%]\ntests/unit/test_utils.py::TestSafetyUtilities::test_safe_get_none_value PASSED [ 98%]\ntests/unit/test_utils.py::TestEdgeCases::test_parse_int_extreme_values PASSED [ 99%]\ntests/unit/test_utils.py::TestEdgeCases::test_validate_bedrooms_edge_cases PASSED [ 99%]\ntests/unit/test_utils.py::TestEdgeCases::test_validate_living_area_warnings PASSED [100%]\n\n=================================== FAILURES ===================================\n_________________ TestPDFExport.test_pdf_export_functionality __________________\ntests/e2e/test_pdf_export.py:134: in test_pdf_export_functionality\n    self.assertEqual(response.headers[\"content-type\"], \"application/pdf\")\nE   AssertionError: 'text/html; charset=utf-8' != 'application/pdf'\nE   - text/html; charset=utf-8\nE   + application/pdf\n________________ TestComprehensive.test_all_chapters_generated _________________\ntests/integration/test_comprehensive.py:21: in test_all_chapters_generated\n    self.assertEqual(len(chapters), 13, f\"Expected 13 chapters, got {len(chapters)}\")\nE   AssertionError: 14 != 13 : Expected 13 chapters, got 14\n__________________ TestIntegration.test_full_flow_with_paste ___________________\ntests/integration/test_integration.py:36: in test_full_flow_with_paste\n    self.assertEqual(resp.status_code, 200)\nE   AssertionError: 405 != 200\n----------------------------- Captured stdout call -----------------------------\n\n[Test] Starting Run...\n______________________ test_consistency_check_happy_path _______________________\ntests/test_verify_consistency.py:30: in test_consistency_check_happy_path\n    assert len(mismatches) == 0, f\"Expected 0 mismatches, found: {mismatches}\"\nE   AssertionError: Expected 0 mismatches, found: [{'field': 'balcony', 'status': 'mismatch', 'source': 'Text Scan', 'parsed': 'Ja', 'message': \"Waarde 'Ja' niet gevonden als losstaand woord.\"}]\nE   assert 1 == 0\nE    +  where 1 = len([{'field': 'balcony', 'message': \"Waarde 'Ja' niet gevonden als losstaand woord.\", 'parsed': 'Ja', 'source': 'Text Scan', ...}])\n------------------------------ Captured log call -------------------------------\nWARNING  backend.consistency:consistency.py:135 Consistency Issues: 1 fields mismatch.\n____________________ test_preferences_sync_with_ai_settings ____________________\ntests/unit/test_ai_refactor.py:97: in test_preferences_sync_with_ai_settings\n    assert ai_config[\"provider\"] == \"gemini\"\nE   AssertionError: assert 'ollama' == 'gemini'\nE     \nE     - gemini\nE     + ollama\n__________________ TestApiEndpoints.test_create_run_defaults ___________________\ntests/unit/test_api_endpoints.py:18: in test_create_run_defaults\n    self.assertEqual(resp.status_code, 200)\nE   AssertionError: 405 != 200\n__________________ TestApiEndpoints.test_get_nonexistent_run ___________________\ntests/unit/test_api_endpoints.py:26: in test_get_nonexistent_run\n    self.assertEqual(resp.status_code, 404)\nE   AssertionError: 200 != 404\n______________________ TestApiEndpoints.test_health_check ______________________\ntests/unit/test_api_endpoints.py:59: in test_health_check\n    data = resp.json()\n           ^^^^^^^^^^^\n../../../Library/Python/3.11/lib/python/site-packages/httpx/_models.py:832: in json\n    return jsonlib.loads(self.content, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py:346: in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/decoder.py:337: in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/decoder.py:355: in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\nE   json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\n________________ TestApiEndpoints.test_start_run_updates_status ________________\ntests/unit/test_api_endpoints.py:32: in test_start_run_updates_status\n    run_id = create_resp.json()[\"run_id\"]\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   KeyError: 'run_id'\n_____________ TestAsyncPipeline.test_start_run_returns_immediately _____________\ntests/unit/test_async_pipeline.py:40: in test_start_run_returns_immediately\n    assert create_response.status_code == 200\nE   assert 405 == 200\nE    +  where 405 = <Response [405 Method Not Allowed]>.status_code\n____________ TestAsyncPipeline.test_status_polling_endpoint_exists _____________\ntests/unit/test_async_pipeline.py:61: in test_status_polling_endpoint_exists\n    run_id = create_response.json()[\"run_id\"]\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   KeyError: 'run_id'\n__________ TestAsyncPipeline.test_status_polling_progress_calculation __________\ntests/unit/test_async_pipeline.py:80: in test_status_polling_progress_calculation\n    run_id = create_response.json()[\"run_id\"]\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   KeyError: 'run_id'\n________ TestAsyncPipeline.test_status_endpoint_404_for_nonexistent_run ________\ntests/unit/test_async_pipeline.py:96: in test_status_endpoint_404_for_nonexistent_run\n    assert response.status_code == 404\nE   assert 200 == 404\nE    +  where 200 = <Response [200 OK]>.status_code\n______________ TestAsyncPipeline.test_pipeline_runs_in_background ______________\ntests/unit/test_async_pipeline.py:105: in test_pipeline_runs_in_background\n    run_id = create_response.json()[\"run_id\"]\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   KeyError: 'run_id'\n_____________ TestAsyncPipeline.test_multiple_concurrent_pipelines _____________\ntests/unit/test_async_pipeline.py:141: in test_multiple_concurrent_pipelines\n    run_ids.append(response.json()[\"run_id\"])\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   KeyError: 'run_id'\n___________________ TestThreadExecutor.test_executor_exists ____________________\ntests/unit/test_async_pipeline.py:162: in test_executor_exists\n    assert executor._max_workers == settings.pipeline.max_workers\nE   AssertionError: assert 10 == 2\nE    +  where 10 = <concurrent.futures.thread.ThreadPoolExecutor object at 0x111cad550>._max_workers\nE    +  and   2 = PipelineSettings(max_workers=2, image_max_size_mb=10, poll_interval_ms=2000).max_workers\nE    +    where PipelineSettings(max_workers=2, image_max_size_mb=10, poll_interval_ms=2000) = AppSettings(ai=AISettings(provider='ollama', model='llama3', timeout=30, fallback_enabled=True, openai_api_key=None, anthropic_api_key=None, gemini_api_key=None, ollama_base_url=None), market=MarketSettings(avg_price_m2=5200, energy_label_scores={'A': 95, 'B': 80, 'C': 65, 'D': 50, 'E': 35, 'F': 20, 'G': 10}), fit_score=FitScoreSettings(base=0.5, completeness_bonus=0.2, energy_bonus=0.15), validation=ValidationSettings(max_bedrooms=15, max_bathrooms=10, max_total_rooms=30, min_living_area=10, max_living_area=2000, min_build_year=1500, max_build_year=2030), pipeline=PipelineSettings(max_workers=2, image_max_size_mb=10, poll_interval_ms=2000), preferences=UserPreferencesSettings(marcel_keywords=['glasvezel', 'zonnepanelen', 'garage', 'laadpaal', '1930'], marcel_tech_weight=0.4, marcel_infrastructure_weight=0.3, marcel_energy_weight=0.3, marcel_hidden_priorities=['bouwjaar', 'dakisolatie'], petra_keywords=['karakteristiek', 'sfeer', 'tuin', 'bad', 'licht'], petra_atmosphere_weight=0.4, petra_comfort_weight=0.3, petra_finish_weight=0.3, petra_hidden_priorities=['afwerking', 'badkamer']), chapters=ChapterSettings(titles={'0': 'Introductie & Samenvatting', '1': 'Algemene Woningkenmerken', '2': 'Matchanalyse Marcel & Petra', '3': 'Bouwkundige Staat', '4': 'Energie & Duurzaamheid', '5': 'Indeling & Ruimtegebruik', '6': 'Onderhoud & Afwerking', '7': 'Tuin & Buitenruimte', '8': 'Parkeren & Bereikbaarheid', '9': 'Juridische Aspecten', '10': 'Financi\u00eble Analyse', '11': 'Marktpositie', '12': 'Advies & Conclusie'}), database_url='/Users/marcelkurvers/Development/funda-app/data/local_app.db').pipeline\n__________ TestBackwardCompatibility.test_report_endpoint_still_works __________\ntests/unit/test_async_pipeline.py:179: in test_report_endpoint_still_works\n    run_id = create_response.json()[\"run_id\"]\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   KeyError: 'run_id'\n_________ TestBackwardCompatibility.test_create_run_endpoint_unchanged _________\ntests/unit/test_async_pipeline.py:200: in test_create_run_endpoint_unchanged\n    assert response.status_code == 200\nE   assert 405 == 200\nE    +  where 405 = <Response [405 Method Not Allowed]>.status_code\n____________________ TestChapter0Logic.test_address_cleanup ____________________\ntests/unit/test_chapter_0_logic.py:17: in test_address_cleanup\n    output = chapter.generate()\n             ^^^^^^^^^^^^^^^^^^\nchapters/chapter_0.py:240: in generate\n    final_content = self._render_rich_narrative(narrative, extra_html=dashboard_extra_html)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\n___________________ TestChapter0Logic.test_robotic_currency ____________________\ntests/unit/test_chapter_0_logic.py:34: in test_robotic_currency\n    output = chapter.generate()\n             ^^^^^^^^^^^^^^^^^^\nchapters/chapter_0.py:240: in generate\n    final_content = self._render_rich_narrative(narrative, extra_html=dashboard_extra_html)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n________________ TestChapter0Logic.test_maintenance_consistency ________________\ntests/unit/test_chapter_0_logic.py:50: in test_maintenance_consistency\n    output = chapter.generate()\n             ^^^^^^^^^^^^^^^^^^\nchapters/chapter_0.py:240: in generate\n    final_content = self._render_rich_narrative(narrative, extra_html=dashboard_extra_html)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\n_______________ TestChapterRoutines.test_unique_layout_per_page ________________\ntests/unit/test_chapter_routines.py:72: in test_unique_layout_per_page\n    output = chapter_instance.generate()\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nchapters/chapter_0.py:240: in generate\n    final_content = self._render_rich_narrative(narrative, extra_html=dashboard_extra_html)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n\nDuring handling of the above exception, another exception occurred:\ntests/unit/test_chapter_routines.py:74: in test_unique_layout_per_page\n    self.fail(f\"Chapter {chapter_id} failed to generate: {e}\")\nE   AssertionError: Chapter 0 failed to generate: 'int' object is not subscriptable\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n_________ TestChapterRoutines.test_z_generate_design_compliance_report _________\ntests/unit/test_chapter_routines.py:188: in test_z_generate_design_compliance_report\n    \"name\": output.title,\n            ^^^^^^\nE   UnboundLocalError: cannot access local variable 'output' where it is not associated with a value\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\n_____________________ TestChapters.test_chapter_generation _____________________\ntests/unit/test_chapters.py:38: in test_chapter_generation\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nchapters/chapter_0.py:240: in generate\n    final_content = self._render_rich_narrative(narrative, extra_html=dashboard_extra_html)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n______________ TestDisplayUnits.test_derived_metrics_consistency _______________\ntests/unit/test_display_units.py:19: in setUp\n    self.chapters = build_chapters(self.core_data)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nmain.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766438864805, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n________________ TestDisplayUnits.test_no_duplicate_m2_in_hero _________________\ntests/unit/test_display_units.py:19: in setUp\n    self.chapters = build_chapters(self.core_data)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nmain.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766438864820, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n_______________ TestDisplayUnits.test_no_duplicate_m2_in_metrics _______________\ntests/unit/test_display_units.py:19: in setUp\n    self.chapters = build_chapters(self.core_data)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nmain.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766438864835, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n_____________ TestDisplayUnits.test_price_m2_calculation_accuracy ______________\ntests/unit/test_display_units.py:19: in setUp\n    self.chapters = build_chapters(self.core_data)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nmain.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766438864849, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=1) __\ntests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nchapters/chapter_1.py:68: in generate\n    main_content = self._render_rich_narrative(narrative)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=2) __\ntests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nchapters/chapter_2.py:75: in generate\n    \"main\": {\"title\": \"Marcel & Petra Matchoverzicht\", \"content\": self._render_rich_narrative(narrative)},\n                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=3) __\ntests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nchapters/chapter_3.py:60: in generate\n    risk_html = self._render_rich_narrative(narrative, extra_html=f\"\"\"\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=4) __\ntests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nchapters/chapter_4.py:75: in generate\n    imp_html = self._render_rich_narrative(narrative, extra_html=f\"\"\"\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=5) __\ntests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nchapters/chapter_5.py:63: in generate\n    main_content = self._render_rich_narrative(narrative, extra_html=f\"\"\"\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=6) __\ntests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nchapters/chapter_6.py:54: in generate\n    main_content = self._render_rich_narrative(narrative, extra_html=f\"\"\"\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=7) __\ntests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nchapters/chapter_7.py:54: in generate\n    main_content = self._render_rich_narrative(narrative, extra_html=f\"\"\"\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=8) __\ntests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nchapters/chapter_8.py:52: in generate\n    main_content = self._render_rich_narrative(narrative, extra_html=f\"\"\"\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=9) __\ntests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nchapters/chapter_9.py:49: in generate\n    main_content = self._render_rich_narrative(narrative, extra_html=f\"\"\"\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=10) _\ntests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nchapters/chapter_10.py:59: in generate\n    breakdown_html = self._render_rich_narrative(narrative, extra_html=f\"\"\"\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=11) _\ntests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nchapters/chapter_11.py:87: in generate\n    main_content = self._render_rich_narrative(narrative, extra_html=f\"\"\"\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n_ TestDynamicChapters.test_all_chapters_generate_modern_dashboard (chapter=12) _\ntests/unit/test_dynamic_chapters.py:51: in test_all_chapters_generate_modern_dashboard\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nchapters/chapter_12.py:22: in generate\n    main_content = self._render_rich_narrative(narrative)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n___________________ TestDynamicChapters.test_chapter_titles ____________________\ntests/unit/test_dynamic_chapters.py:102: in test_chapter_titles\n    self.assertIn(\"Algemene Woningkenmerken\", c1.generate().title)\n                                              ^^^^^^^^^^^^^\nchapters/chapter_1.py:68: in generate\n    main_content = self._render_rich_narrative(narrative)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 1: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\n__________ TestDynamicChapters.test_dynamic_intelligence_integration ___________\ntests/unit/test_dynamic_chapters.py:84: in test_dynamic_intelligence_integration\n    output = instance.generate()\n             ^^^^^^^^^^^^^^^^^^^\nchapters/chapter_1.py:68: in generate\n    main_content = self._render_rich_narrative(narrative)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nchapters/base.py:81: in _render_rich_narrative\n    <span><ion-icon name=\"time\"></ion-icon> {provenance.get('timestamp', '')[:16]}</span>\n                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   TypeError: 'int' object is not subscriptable\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 1: Ollama failed: Event loop is closed\n______________ TestExploreInsights.test_capture_chapter_insights _______________\ntests/unit/test_explore_insights.py:43: in test_capture_chapter_insights\n    chapters = build_chapters(core_data)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^\nmain.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766438865003, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n----------------------------- Captured stdout call -----------------------------\n\n[INFO] Generating chapters for mock property: Inzichtslaan 42, Toekomststad...\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n__________________ TestRegression.test_chapter_data_bridging ___________________\ntests/unit/test_frontend_compatibility.py:27: in test_chapter_data_bridging\n    chapters = build_chapters(core_data)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^\nmain.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766438865018, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n____________________ TestRegression.test_chapter_id_present ____________________\ntests/unit/test_frontend_compatibility.py:16: in test_chapter_id_present\n    chapters = build_chapters(core_data)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^\nmain.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766438865033, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n____________ TestImageUploadIntegration.test_paste_with_media_urls _____________\ntests/unit/test_image_upload.py:189: in test_paste_with_media_urls\n    assert create_response.status_code == 200\nE   assert 405 == 200\nE    +  where 405 = <Response [405 Method Not Allowed]>.status_code\n___________ TestIntelligenceEngine.test_chapter_0_executive_summary ____________\ntests/unit/test_intelligence.py:56: in test_chapter_0_executive_summary\n    self.assertIn(\"500,000\", nar['intro'])\nE   AssertionError: '500,000' not found in 'Welkom bij de strategische analyse van de Test. Dit rapport combineert harde data met AI-gestuurde interpretaties om een compleet beeld van uw potenti\u00eble aankoop te vormen.'\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\n_______________ TestModernChapter.test_chapter_structure_modern ________________\ntests/unit/test_modern_chapter.py:14: in test_chapter_structure_modern\n    chapters = build_chapters(core_data)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^\nmain.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766438865226, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n_________________ TestModernChapter.test_energy_chapter_layout _________________\ntests/unit/test_modern_chapter.py:59: in test_energy_chapter_layout\n    chapters = build_chapters(core_data)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^\nmain.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766438865240, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n______________ TestModernDesignCompliance.test_all_chapters_exist ______________\ntests/unit/test_modern_design_compliance.py:21: in setUp\n    self.chapters = build_chapters(self.core_data)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nmain.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766438865255, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n________ TestModernDesignCompliance.test_data_integrity_no_placeholders ________\ntests/unit/test_modern_design_compliance.py:21: in setUp\n    self.chapters = build_chapters(self.core_data)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nmain.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766438865309, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n_____________ TestModernDesignCompliance.test_enriched_by_ai_check _____________\ntests/unit/test_modern_design_compliance.py:21: in setUp\n    self.chapters = build_chapters(self.core_data)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nmain.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766438865324, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n________ TestModernDesignCompliance.test_modern_4k_structure_compliance ________\ntests/unit/test_modern_design_compliance.py:21: in setUp\n    self.chapters = build_chapters(self.core_data)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nmain.py:453: in build_chapters\n    prov = AIProvenance(**prov_dict) if prov_dict else None\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\nE   pydantic_core._pydantic_core.ValidationError: 1 validation error for AIProvenance\nE   timestamp\nE     Input should be a valid string [type=string_type, input_value=1766438865338, input_type=int]\nE       For further information visit https://errors.pydantic.dev/2.12/v/string_type\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404\nERROR    main:main.py:439 Failed to generate Rich Chapter 0: 'int' object is not subscriptable\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Event loop is closed\nERROR    intelligence:intelligence.py:340 Deep AI generation failed for Ch 0: Ollama failed: Event loop is closed\n__________ TestOllamaIntegration.test_ai_narrative_generation_success __________\ntests/unit/test_ollama_integration.py:65: in test_ai_narrative_generation_success\n    self.assertIn(\"Deze analyse is gegenereerd door de Funda AI-engine\", result['interpretation'])\nE   AssertionError: 'Deze analyse is gegenereerd door de Funda AI-engine' not found in 'AI Interpretation\\n\\nDeze analyse is gegenereerd door de AI-engine (Deep Analysis Mode).'\n_ TestFactoryRegistryIntegration.test_custom_provider_can_be_registered_and_created _\ntests/unit/test_provider_factory.py:286: in test_custom_provider_can_be_registered_and_created\n    ProviderRegistry.register(\"custom\", CustomProvider)\n    ^^^^^^^^^^^^^^^^\nE   NameError: name 'ProviderRegistry' is not defined\n_____ TestProviderFactoryErrorHandling.test_case_sensitive_provider_names ______\ntests/unit/test_provider_factory.py:355: in test_case_sensitive_provider_names\n    with pytest.raises(ValueError, match=\"Unknown provider: OPENAI\"):\nE   Failed: DID NOT RAISE <class 'ValueError'>\n____________ TestOllamaProvider.test_ollama_list_models_http_error _____________\ntests/unit/test_providers.py:134: in test_ollama_list_models_http_error\n    assert models == []\nE   AssertionError: assert ['llama3', 'm...', 'llama3.1'] == []\nE     \nE     Left contains 5 more items, first extra item: 'llama3'\nE     \nE     Full diff:\nE     - []\nE     + [\nE     +     'llama3',...\nE     \nE     ...Full output truncated (5 lines hidden), use '-vv' to show\n_________ TestOllamaProvider.test_ollama_list_models_connection_error __________\ntests/unit/test_providers.py:149: in test_ollama_list_models_connection_error\n    assert models == []\nE   AssertionError: assert ['llama3', 'm...', 'llama3.1'] == []\nE     \nE     Left contains 5 more items, first extra item: 'llama3'\nE     \nE     Full diff:\nE     - []\nE     + [\nE     +     'llama3',...\nE     \nE     ...Full output truncated (5 lines hidden), use '-vv' to show\n_______________ TestOllamaProvider.test_ollama_generate_timeout ________________\nai/providers/ollama_provider.py:96: in generate\n    response = await client.post(self.generate_endpoint, json=payload)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/unittest/mock.py:2237: in _execute_mock_call\n    raise effect\nE   httpx.TimeoutException: Timeout\n\nDuring handling of the above exception, another exception occurred:\ntests/unit/test_providers.py:187: in test_ollama_generate_timeout\n    result = await provider.generate(prompt=\"Test\")\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nai/providers/ollama_provider.py:101: in generate\n    raise RuntimeError(f\"Ollama failed: {str(e)}\")\nE   RuntimeError: Ollama failed: Timeout\n------------------------------ Captured log call -------------------------------\nERROR    ai.providers.ollama_provider:ollama_provider.py:100 Ollama generation failed: Timeout\n_______________ TestOpenAIProvider.test_openai_generate_success ________________\ntests/unit/test_providers.py:284: in test_openai_generate_success\n    provider.client.chat.completions.create = AsyncMock(return_value=mock_response)\n    ^^^^^^^^^^^^^^^^^^^^\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/functools.py:1001: in __get__\n    val = self.func(instance)\n          ^^^^^^^^^^^^^^^^^^^\n../../../Library/Python/3.11/lib/python/site-packages/openai/_client.py:494: in chat\n    from .resources.chat import AsyncChat\nE   ModuleNotFoundError: No module named 'openai.resources'; 'openai' is not a package\n____________ TestOpenAIProvider.test_openai_generate_with_json_mode ____________\ntests/unit/test_providers.py:308: in test_openai_generate_with_json_mode\n    provider.client.chat.completions.create = AsyncMock(return_value=mock_response)\n    ^^^^^^^^^^^^^^^^^^^^\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/functools.py:1001: in __get__\n    val = self.func(instance)\n          ^^^^^^^^^^^^^^^^^^^\n../../../Library/Python/3.11/lib/python/site-packages/openai/_client.py:494: in chat\n    from .resources.chat import AsyncChat\nE   ModuleNotFoundError: No module named 'openai.resources'; 'openai' is not a package\n____________ TestOpenAIProvider.test_openai_generate_error_handling ____________\ntests/unit/test_providers.py:322: in test_openai_generate_error_handling\n    provider.client.chat.completions.create = AsyncMock(\n    ^^^^^^^^^^^^^^^^^^^^\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/functools.py:1001: in __get__\n    val = self.func(instance)\n          ^^^^^^^^^^^^^^^^^^^\n../../../Library/Python/3.11/lib/python/site-packages/openai/_client.py:494: in chat\n    from .resources.chat import AsyncChat\nE   ModuleNotFoundError: No module named 'openai.resources'; 'openai' is not a package\n_____________ TestOpenAIProvider.test_openai_check_health_success ______________\ntests/unit/test_providers.py:335: in test_openai_check_health_success\n    provider.client.chat.completions.create = AsyncMock(return_value=mock_response)\n    ^^^^^^^^^^^^^^^^^^^^\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/functools.py:1001: in __get__\n    val = self.func(instance)\n          ^^^^^^^^^^^^^^^^^^^\n../../../Library/Python/3.11/lib/python/site-packages/openai/_client.py:494: in chat\n    from .resources.chat import AsyncChat\nE   ModuleNotFoundError: No module named 'openai.resources'; 'openai' is not a package\n_____________ TestOpenAIProvider.test_openai_check_health_failure ______________\ntests/unit/test_providers.py:346: in test_openai_check_health_failure\n    provider.client.chat.completions.create = AsyncMock(\n    ^^^^^^^^^^^^^^^^^^^^\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/functools.py:1001: in __get__\n    val = self.func(instance)\n          ^^^^^^^^^^^^^^^^^^^\n../../../Library/Python/3.11/lib/python/site-packages/openai/_client.py:494: in chat\n    from .resources.chat import AsyncChat\nE   ModuleNotFoundError: No module named 'openai.resources'; 'openai' is not a package\n__________ TestAnthropicProvider.test_anthropic_check_health_failure ___________\ntests/unit/test_providers.py:465: in test_anthropic_check_health_failure\n    assert health is False\nE   assert True is False\n_____________ TestGeminiProvider.test_gemini_check_health_success ______________\ntests/unit/test_providers.py:575: in test_gemini_check_health_success\n    provider.client.aio.models.list.return_value = mock_iterator\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   AttributeError: 'method' object has no attribute 'return_value'\n_____________ TestGeminiProvider.test_gemini_check_health_failure ______________\ntests/unit/test_providers.py:595: in test_gemini_check_health_failure\n    provider.client.aio.models.list.side_effect = Exception(\"Error\")\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE   AttributeError: 'method' object has no attribute 'side_effect'\n=========================== short test summary info ============================\nFAILED tests/e2e/test_pdf_export.py::TestPDFExport::test_pdf_export_functionality\nFAILED tests/integration/test_comprehensive.py::TestComprehensive::test_all_chapters_generated\nFAILED tests/integration/test_integration.py::TestIntegration::test_full_flow_with_paste\nFAILED tests/test_verify_consistency.py::test_consistency_check_happy_path - ...\nFAILED tests/unit/test_ai_refactor.py::test_preferences_sync_with_ai_settings\nFAILED tests/unit/test_api_endpoints.py::TestApiEndpoints::test_create_run_defaults\nFAILED tests/unit/test_api_endpoints.py::TestApiEndpoints::test_get_nonexistent_run\nFAILED tests/unit/test_api_endpoints.py::TestApiEndpoints::test_health_check\nFAILED tests/unit/test_api_endpoints.py::TestApiEndpoints::test_start_run_updates_status\nFAILED tests/unit/test_async_pipeline.py::TestAsyncPipeline::test_start_run_returns_immediately\nFAILED tests/unit/test_async_pipeline.py::TestAsyncPipeline::test_status_polling_endpoint_exists\nFAILED tests/unit/test_async_pipeline.py::TestAsyncPipeline::test_status_polling_progress_calculation\nFAILED tests/unit/test_async_pipeline.py::TestAsyncPipeline::test_status_endpoint_404_for_nonexistent_run\nFAILED tests/unit/test_async_pipeline.py::TestAsyncPipeline::test_pipeline_runs_in_background\nFAILED tests/unit/test_async_pipeline.py::TestAsyncPipeline::test_multiple_concurrent_pipelines\nFAILED tests/unit/test_async_pipeline.py::TestThreadExecutor::test_executor_exists\nFAILED tests/unit/test_async_pipeline.py::TestBackwardCompatibility::test_report_endpoint_still_works\nFAILED tests/unit/test_async_pipeline.py::TestBackwardCompatibility::test_create_run_endpoint_unchanged\nFAILED tests/unit/test_chapter_0_logic.py::TestChapter0Logic::test_address_cleanup\nFAILED tests/unit/test_chapter_0_logic.py::TestChapter0Logic::test_robotic_currency\nFAILED tests/unit/test_chapter_0_logic.py::TestChapter0Logic::test_maintenance_consistency\nFAILED tests/unit/test_chapter_routines.py::TestChapterRoutines::test_unique_layout_per_page\nFAILED tests/unit/test_chapter_routines.py::TestChapterRoutines::test_z_generate_design_compliance_report\nFAILED tests/unit/test_chapters.py::TestChapters::test_chapter_generation - T...\nFAILED tests/unit/test_display_units.py::TestDisplayUnits::test_derived_metrics_consistency\nFAILED tests/unit/test_display_units.py::TestDisplayUnits::test_no_duplicate_m2_in_hero\nFAILED tests/unit/test_display_units.py::TestDisplayUnits::test_no_duplicate_m2_in_metrics\nFAILED tests/unit/test_display_units.py::TestDisplayUnits::test_price_m2_calculation_accuracy\nSUBFAILED(chapter=1) tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=2) tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=3) tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=4) tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=5) tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=6) tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=7) tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=8) tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=9) tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=10) tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=11) tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nSUBFAILED(chapter=12) tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_all_chapters_generate_modern_dashboard\nFAILED tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_chapter_titles\nFAILED tests/unit/test_dynamic_chapters.py::TestDynamicChapters::test_dynamic_intelligence_integration\nFAILED tests/unit/test_explore_insights.py::TestExploreInsights::test_capture_chapter_insights\nFAILED tests/unit/test_frontend_compatibility.py::TestRegression::test_chapter_data_bridging\nFAILED tests/unit/test_frontend_compatibility.py::TestRegression::test_chapter_id_present\nFAILED tests/unit/test_image_upload.py::TestImageUploadIntegration::test_paste_with_media_urls\nFAILED tests/unit/test_intelligence.py::TestIntelligenceEngine::test_chapter_0_executive_summary\nFAILED tests/unit/test_modern_chapter.py::TestModernChapter::test_chapter_structure_modern\nFAILED tests/unit/test_modern_chapter.py::TestModernChapter::test_energy_chapter_layout\nFAILED tests/unit/test_modern_design_compliance.py::TestModernDesignCompliance::test_all_chapters_exist\nFAILED tests/unit/test_modern_design_compliance.py::TestModernDesignCompliance::test_data_integrity_no_placeholders\nFAILED tests/unit/test_modern_design_compliance.py::TestModernDesignCompliance::test_enriched_by_ai_check\nFAILED tests/unit/test_modern_design_compliance.py::TestModernDesignCompliance::test_modern_4k_structure_compliance\nFAILED tests/unit/test_ollama_integration.py::TestOllamaIntegration::test_ai_narrative_generation_success\nFAILED tests/unit/test_provider_factory.py::TestFactoryRegistryIntegration::test_custom_provider_can_be_registered_and_created\nFAILED tests/unit/test_provider_factory.py::TestProviderFactoryErrorHandling::test_case_sensitive_provider_names\nFAILED tests/unit/test_providers.py::TestOllamaProvider::test_ollama_list_models_http_error\nFAILED tests/unit/test_providers.py::TestOllamaProvider::test_ollama_list_models_connection_error\nFAILED tests/unit/test_providers.py::TestOllamaProvider::test_ollama_generate_timeout\nFAILED tests/unit/test_providers.py::TestOpenAIProvider::test_openai_generate_success\nFAILED tests/unit/test_providers.py::TestOpenAIProvider::test_openai_generate_with_json_mode\nFAILED tests/unit/test_providers.py::TestOpenAIProvider::test_openai_generate_error_handling\nFAILED tests/unit/test_providers.py::TestOpenAIProvider::test_openai_check_health_success\nFAILED tests/unit/test_providers.py::TestOpenAIProvider::test_openai_check_health_failure\nFAILED tests/unit/test_providers.py::TestAnthropicProvider::test_anthropic_check_health_failure\nFAILED tests/unit/test_providers.py::TestGeminiProvider::test_gemini_check_health_success\nFAILED tests/unit/test_providers.py::TestGeminiProvider::test_gemini_check_health_failure\n======= 67 failed, 151 passed, 206 warnings, 28 subtests passed in 5.22s =======",
      "start_time": "2025-12-22T21:27:40.551312Z",
      "end_time": "2025-12-22T21:27:46.465224Z",
      "status": "failed",
      "reason": null,
      "parsed_results": null
    },
    {
      "framework": "jest",
      "command": "npx jest --runInBand",
      "exit_code": -1,
      "raw_output": "Skipped: no JS/TS test files found.",
      "start_time": "2025-12-22T21:27:40.551098Z",
      "end_time": "2025-12-22T21:27:40.551098Z",
      "status": "skipped",
      "reason": "Detected 2 JS/TS source files but no test files to execute.",
      "parsed_results": null
    },
    {
      "framework": "go test",
      "command": "go test ./... -v",
      "exit_code": -1,
      "raw_output": "Skipped: no Go source files detected.",
      "start_time": "2025-12-22T21:27:40.551098Z",
      "end_time": "2025-12-22T21:27:40.551098Z",
      "status": "skipped",
      "reason": "No Go source files detected in repository.",
      "parsed_results": null
    },
    {
      "framework": "cargo test",
      "command": "cargo test --verbose",
      "exit_code": -1,
      "raw_output": "Skipped: no Rust source files detected.",
      "start_time": "2025-12-22T21:27:40.551098Z",
      "end_time": "2025-12-22T21:27:40.551098Z",
      "status": "skipped",
      "reason": "No Rust source files detected in repository.",
      "parsed_results": null
    },
    {
      "framework": "maven/gradle",
      "command": "mvn test || gradle test",
      "exit_code": -1,
      "raw_output": "Skipped: no Java source files detected.",
      "start_time": "2025-12-22T21:27:40.551098Z",
      "end_time": "2025-12-22T21:27:40.551098Z",
      "status": "skipped",
      "reason": "No Java source files detected in repository.",
      "parsed_results": null
    },
    {
      "framework": "rspec/minitest",
      "command": "rspec || rake test",
      "exit_code": -1,
      "raw_output": "Skipped: no Ruby source files detected.",
      "start_time": "2025-12-22T21:27:40.551098Z",
      "end_time": "2025-12-22T21:27:40.551098Z",
      "status": "skipped",
      "reason": "No Ruby source files detected in repository.",
      "parsed_results": null
    }
  ]
}